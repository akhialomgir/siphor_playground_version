(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,37372,e=>{e.v({deductions:{scoreType:"deduction",items:[{id:"0",name:"bili",score:15,type:"fixed"},{id:"1",name:"game",type:"tiered",baseType:"duration",criteria:[{time:1800,score:10}]},{id:"2",name:"sosx",score:50,type:"fixed"}]},regularGains:{scoreType:"gain",items:[{id:"0",name:"focus",type:"tiered",baseType:"duration",criteria:[{time:3600,score:5},{time:7200,score:10},{time:10800,score:20},{time:14400,score:25},{time:18e3,score:35}]},{id:"1",name:"exercise",score:10,type:"fixed"},{id:"2",name:"sleep",type:"conditional",baseType:"relativeTime",criteria:[{time:79200,comparison:"before",score:5},{time:82800,comparison:"before",score:10}]}]},targetGains:{scoreType:"gain",items:[{id:"0",name:"programming",score:15,type:"fixed"},{id:"1",name:"algorithm",score:15,type:"fixed"},{id:"2",name:"interview",score:20,type:"fixed"},{id:"3",name:"paint",score:10,type:"fixed"},{id:"4",name:"reading",score:5,type:"fixed"},{id:"5",name:"mindfulness",score:10,type:"fixed"}]}})},5987,e=>{"use strict";var t=e.i(43476),r=e.i(71645);let i=(0,r.createContext)(void 0);function a({children:e}){let[a,n]=(0,r.useState)(new Set),o=(0,r.useCallback)(e=>n(new Set(e)),[]),l=(0,r.useMemo)(()=>({selectedIds:a,replaceAll:o}),[a,o]);return(0,t.jsx)(i.Provider,{value:l,children:e})}function n(){let e=(0,r.useContext)(i);if(!e)throw Error("useDroppedItems must be used within DroppedItemsProvider");return e}e.s(["DroppedItemsProvider",()=>a,"useDroppedItems",()=>n])},24335,e=>{"use strict";var t=e.i(43476),r=e.i(71645),i=e.i(37372),a=e.i(5987);function n(){let[e,n]=(0,r.useState)(null),{selectedIds:o}=(0,a.useDroppedItems)();if((0,r.useEffect)(()=>{n(i.default)},[]),!e)return(0,t.jsx)("div",{children:"Loading..."});let l={padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:500},s={pts:{backgroundColor:"#113227",color:"#6ee7b7"},time:{backgroundColor:"#10233d",color:"#93c5fd"}},d=({variant:e,children:r})=>(0,t.jsx)("span",{style:{...l,...s[e]},children:r}),c=({children:e})=>(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"6px"},children:e});return(0,t.jsx)("div",{style:{padding:"20px",fontFamily:"system-ui, -apple-system, sans-serif",backgroundColor:"#0b1220",color:"#e5e7eb"},children:(0,t.jsx)("div",{style:{display:"grid",gap:"20px"},children:Object.entries(e).map(([e,r])=>(0,t.jsxs)("div",{style:{border:"2px solid #243046",borderRadius:"8px",overflow:"hidden",backgroundColor:"#0f1625",boxShadow:"0 6px 20px rgba(0,0,0,0.35)"},children:[(0,t.jsxs)("div",{style:{backgroundColor:"#111827",padding:"12px 16px",borderBottom:"2px solid #243046",fontWeight:600,fontSize:"16px",color:"#e5e7eb"},children:[{deductions:"Deductions",regularGains:"Regular Gains",targetGains:"Target Gains"}[e]||e,(0,t.jsxs)("span",{style:{marginLeft:"12px",fontSize:"12px",color:"#94a3b8"},children:["(","gain"===r.scoreType?"Gain":"Deduction",")"]})]}),(0,t.jsx)("div",{children:r.items.map((i,a)=>{let n=i.criteria&&i.criteria.length>0,l=(e=>{if(!e.criteria||0===e.criteria.length)return null;let r=e.criteria.map((r,i)=>{let a="";if("duration"===e.baseType){var n;let e,t;e=Math.floor((n=r.time)/3600),t=Math.floor(n%3600/60),a=e>0?t>0?`${e}h${t}m`:`${e}h`:`${t}m`}else if("relativeTime"===e.baseType){let e=new Date(0);e.setSeconds(r.time);let t=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1});a=`${r.comparison} ${t}`}return(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"8px"},children:[a&&(0,t.jsx)(d,{variant:"time",children:a}),(0,t.jsxs)(d,{variant:"pts",children:[r.score," pts"]})]},`${e.id}-crit-${i}-${r.time}-${r.score}`)});if(r.length>2){let i=[];for(let a=0;a<r.length;a+=2){let n=r.slice(a,a+2);i.push((0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"6px"},children:n},`crit-col-${e.id}-${a}`))}return(0,t.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",flexWrap:"wrap",gap:"8px"},children:i})}return(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"6px"},children:r})})(i),s=`${e}-${i.id}`,u=o.has(s);return(0,t.jsxs)("div",{draggable:!0,onDragStart:t=>{let a={id:`${e}-${i.id}`,name:i.name,scoreType:"gain"===r.scoreType?"gain":"deduction",score:i.score,criteria:i.criteria??[],baseType:i.baseType,categoryKey:e};t.dataTransfer.setData("application/json",JSON.stringify(a))},style:{borderBottom:a<r.items.length-1?"1px solid #1f2937":"none",padding:"12px 16px",display:"grid",gridTemplateColumns:"1fr auto",gap:"8px",...u?{backgroundColor:"rgba(110, 231, 183, 0.14)",outline:"1px solid rgba(110, 231, 183, 0.28)",borderRadius:"6px"}:{}},children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{style:{marginBottom:n?"8px":"0"},children:[(0,t.jsx)("span",{style:{fontWeight:500,fontSize:"14px",color:"#e5e7eb"},children:i.name}),(0,t.jsxs)("span",{style:{marginLeft:"8px",color:"#94a3b8",fontSize:"12px"},children:["(ID: ",i.id,")"]})]}),i.type&&(0,t.jsx)("span",{style:{display:"inline-block",backgroundColor:"#1f2937",padding:"2px 6px",borderRadius:"3px",fontSize:"12px",color:"#cbd5e1"},children:i.type})]}),(0,t.jsxs)(c,{children:["number"==typeof i.score&&(0,t.jsxs)(d,{variant:"pts",children:[i.score," pts"]}),l]})]},i.id)})})]},e))})})}e.s(["default",()=>n])},89431,e=>{e.v({"clear-wiggle":"DragDropBox-module__HXSG-G__clear-wiggle",clearButton:"DragDropBox-module__HXSG-G__clearButton",clearButtonActive:"DragDropBox-module__HXSG-G__clearButtonActive",dateChip:"DragDropBox-module__HXSG-G__dateChip",entry:"DragDropBox-module__HXSG-G__entry","entry-glow":"DragDropBox-module__HXSG-G__entry-glow",entryHighlight:"DragDropBox-module__HXSG-G__entryHighlight",section:"DragDropBox-module__HXSG-G__section"})},55167,e=>{"use strict";let t="entries";function r(){return new Promise((e,r)=>{if(!window.indexedDB)return void r(Error("IndexedDB not available"));let i=indexedDB.open("dragDropBox",1);i.onupgradeneeded=()=>{let e=i.result;e.objectStoreNames.contains(t)||e.createObjectStore(t)},i.onsuccess=()=>e(i.result),i.onerror=()=>r(i.error??Error("Failed to open IndexedDB"))})}async function i(e){try{let i=await r();return await new Promise((r,a)=>{let n=i.transaction(t,"readonly").objectStore(t).get(e);n.onsuccess=()=>{let e=n.result??{deductions:[],gains:[]};r({deductions:e.deductions??[],gains:e.gains??[]})},n.onerror=()=>a(n.error??Error("Read failed"))})}catch(e){return{deductions:[],gains:[]}}}async function a(e,i,a){try{let n=await r();await new Promise((r,o)=>{let l=n.transaction(t,"readwrite").objectStore(t).put({deductions:i,gains:a},e);l.onsuccess=()=>r(),l.onerror=()=>o(l.error??Error("Write failed"))})}catch(e){}}async function n(e){try{let i=await r();await new Promise((r,a)=>{let n=i.transaction(t,"readwrite").objectStore(t).delete(e);n.onsuccess=()=>r(),n.onerror=()=>a(n.error??Error("Delete failed"))})}catch(e){}}async function o(){try{let e=await r();return await new Promise((r,i)=>{let a=e.transaction(t,"readonly").objectStore(t),n=a.getAllKeys();n.onsuccess=async()=>{let e=n.result.filter(Boolean),t=[],o=e.map(e=>new Promise((r,i)=>{let n=a.get(e);n.onsuccess=()=>{let i=n.result??{deductions:[],gains:[]};t.push({dateKey:e,state:i}),r()},n.onerror=()=>i(n.error??Error("Read failed"))}));try{await Promise.all(o),r(t)}catch(e){i(e)}},n.onerror=()=>i(n.error??Error("List keys failed"))})}catch(e){return[]}}e.s(["clearPersistedState",()=>n,"listAllStates",()=>o,"loadPersistedState",()=>i,"savePersistedState",()=>a])},36999,e=>{e.v({calendarContainer:"Calendar-module__rMASNW__calendarContainer",calendarHeader:"Calendar-module__rMASNW__calendarHeader",calendarOverlay:"Calendar-module__rMASNW__calendarOverlay",day:"Calendar-module__rMASNW__day",days:"Calendar-module__rMASNW__days",empty:"Calendar-module__rMASNW__empty",fadeIn:"Calendar-module__rMASNW__fadeIn",future:"Calendar-module__rMASNW__future",hasData:"Calendar-module__rMASNW__hasData",monthYear:"Calendar-module__rMASNW__monthYear",navButton:"Calendar-module__rMASNW__navButton",noData:"Calendar-module__rMASNW__noData",selected:"Calendar-module__rMASNW__selected",slideUp:"Calendar-module__rMASNW__slideUp",weekday:"Calendar-module__rMASNW__weekday",weekdays:"Calendar-module__rMASNW__weekdays"})},32833,e=>{"use strict";var t=e.i(43476),r=e.i(71645);let i=(0,r.createContext)(void 0);function a({children:e}){let[a,n]=(0,r.useState)(()=>new Date().toISOString().slice(0,10));return(0,t.jsx)(i.Provider,{value:{selectedDate:a,setSelectedDate:n},children:e})}function n(){let e=(0,r.useContext)(i);if(!e)throw Error("useSelectedDate must be used within DateProvider");return e}e.s(["DateProvider",()=>a,"useSelectedDate",()=>n])},60057,e=>{"use strict";var t=e.i(43476),r=e.i(71645),i=e.i(89431),a=e.i(5987),n=e.i(55167),o=e.i(36999);function l(e){if(e.criteria&&e.criteria.length>0){let t=Math.max(0,e.selectedIndex??0);return(e.criteria[t]?.score??0)+10*!!e.bonusActive}return(e.fixedScore??0)+10*!!e.bonusActive}function s({selectedDate:e,onDateSelect:i,onClose:a}){let[s,d]=(0,r.useState)(()=>{let[t,r,i]=e.split("-").map(Number);return new Date(t,r-1,i)}),[c,u]=(0,r.useState)(new Set);(0,r.useEffect)(()=>{(0,n.listAllStates)().then(e=>{let t=new Set;e.forEach(({dateKey:e,state:r})=>{0!=(r.gains??[]).reduce((e,t)=>e+l(t),0)-(r.deductions??[]).reduce((e,t)=>e+l(t),0)&&t.add(e)}),u(t)})},[]);let p=s.getFullYear(),m=s.getMonth(),x=new Date(p,m,1),g=new Date(p,m+1,0).getDate(),f=x.getDay(),y=[];for(let e=0;e<f;e++)y.push(null);for(let e=1;e<=g;e++)y.push(e);let h=new Intl.DateTimeFormat("en-US",{month:"long"}).format(s),b=e=>{let t=`${p}-${String(m+1).padStart(2,"0")}-${String(e).padStart(2,"0")}`;return c.has(t)},S=e=>{let t=new Date(p,m,e),r=new Date;return r.setHours(0,0,0,0),t>r};return(0,t.jsx)("div",{className:o.default.calendarOverlay,onClick:a,children:(0,t.jsxs)("div",{className:o.default.calendarContainer,onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:o.default.calendarHeader,children:[(0,t.jsx)("button",{onClick:()=>{d(new Date(p,m-1,1))},className:o.default.navButton,"aria-label":"Previous month",children:"â€¹"}),(0,t.jsxs)("div",{className:o.default.monthYear,children:[h," ",p]}),(0,t.jsx)("button",{onClick:()=>{d(new Date(p,m+1,1))},className:o.default.navButton,"aria-label":"Next month",children:"â€º"})]}),(0,t.jsx)("div",{className:o.default.weekdays,children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,t.jsx)("div",{className:o.default.weekday,children:e},e))}),(0,t.jsx)("div",{className:o.default.days,children:y.map((r,n)=>(0,t.jsx)("div",{className:`${o.default.day} ${null===r?o.default.empty:""} ${r&&`${p}-${String(m+1).padStart(2,"0")}-${String(r).padStart(2,"0")}`===e?o.default.selected:""} ${r&&b(r)?o.default.hasData:""} ${r&&S(r)?o.default.future:""} ${r&&!b(r)&&!S(r)?o.default.noData:""}`,onClick:()=>null!==r&&void(i(`${p}-${String(m+1).padStart(2,"0")}-${String(r).padStart(2,"0")}`),a()),role:null!==r?"button":void 0,tabIndex:null!==r?0:void 0,children:r},n))})]})})}var d=e.i(32833),c=e.i(37372);function u(e){let t,r=(t=c.default.regularGains.items.find(e=>"focus"===e.name),t?.criteria??[]);for(let t=r.length-1;t>=0;t--)if(e>=r[t].time)return r[t].score;return 0}let p={padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:500},m={backgroundColor:"#113227",color:"#6ee7b7"},x=({value:e})=>(0,t.jsxs)("span",{style:{...p,...m},children:[e," pts"]});function g(e){if(e.criteria&&e.criteria.length>0){let t=Math.max(0,e.selectedIndex??0);return(e.criteria[t]?.score??0)+10*!!e.bonusActive}return(e.fixedScore??0)+10*!!e.bonusActive}function f(e){let t=Math.max(0,Math.floor(e)),r=Math.floor(t/3600),i=Math.floor(t%3600/60);return`${String(r).padStart(2,"0")}:${String(i).padStart(2,"0")}:${String(t%60).padStart(2,"0")}`}function y(e){return e.filter(e=>"targetGains"===e.categoryKey).reduce((e,t)=>e+(t.timerSeconds??0),0)}function h(){let[e,o]=(0,r.useState)([]),[l,c]=(0,r.useState)([]),{selectedDate:p,setSelectedDate:m}=(0,d.useSelectedDate)(),[h,b]=(0,r.useState)(!1),[S,v]=(0,r.useState)(!1),[_,j]=(0,r.useState)(!1),[D,w]=(0,r.useState)(null),[T,C]=(0,r.useState)(0),[$,A]=(0,r.useState)(0),k=(0,r.useRef)(null),{replaceAll:I}=(0,a.useDroppedItems)(),R=()=>p===new Date().toISOString().slice(0,10),M=R(),N=e=>{m(e),o([]),c([]),b(!1)};(0,r.useEffect)(()=>{I([...e,...l].map(e=>e.id))},[e,l,I]),(0,r.useEffect)(()=>{if(!h)return;if(!M){w(null),c(e=>e.map(e=>"targetGains"===e.categoryKey?{...e,timerRunning:!1,timerStartTs:null}:e));return}let e=l.filter(e=>"targetGains"===e.categoryKey),t=e[e.length-1],r=t?.id??null;w(r),c(e=>{let t=Date.now(),i=!1,a=e.map(e=>"targetGains"!==e.categoryKey?e:e.id===r?e.timerRunning&&!e.timerStartTs?(i=!0,{...e,timerStartTs:t}):!1===e.timerRunning&&e.timerStartTs?(i=!0,{...e,timerStartTs:null}):e:e.timerRunning||e.timerStartTs||e.timerPaused?(i=!0,{...e,timerRunning:!1,timerStartTs:null,timerPaused:!1}):e);return i?a:e})},[l,M,h]),(0,r.useEffect)(()=>{if(!M||!D)return;let e=window.setInterval(()=>{c(e=>{let t=Date.now(),r=!1,i=e.map(e=>{if(e.id!==D||"targetGains"!==e.categoryKey||!e.timerRunning||!e.timerStartTs)return e;let i=Math.max(0,Math.floor((t-e.timerStartTs)/1e3));return i<=0?e:(r=!0,{...e,timerSeconds:(e.timerSeconds??0)+i,timerStartTs:t})});if(r){let e=y(i);A(e),C(u(e))}return r?i:e})},1e3);return()=>window.clearInterval(e)},[D,M]),(0,r.useEffect)(()=>{let e=y(l);A(e),C(u(e))},[l]),(0,r.useEffect)(()=>{if(!M||!D)return;let e=window.setInterval(()=>{c(e=>{let t=Date.now(),r=!1,i=e.map(e=>{if(e.id!==D||"targetGains"!==e.categoryKey||!e.timerRunning||!e.timerStartTs)return e;let i=Math.max(0,Math.floor((t-e.timerStartTs)/1e3));return i<=0?e:(r=!0,{...e,timerSeconds:(e.timerSeconds??0)+i,timerStartTs:t})});return r?i:e})},1e3);return()=>window.clearInterval(e)},[D,M]),(0,r.useEffect)(()=>{let e=!0;return(0,n.loadPersistedState)(p).then(t=>{if(!e)return;let r=Date.now(),i=e=>e.map(e=>{let t={...e,justAdded:!1,timerPaused:e.timerPaused??!1};if("targetGains"===t.categoryKey){let e=t.timerSeconds??0;if(t.timerRunning&&M&&t.timerStartTs){let i=Math.max(0,Math.floor((r-t.timerStartTs)/1e3));t={...t,timerSeconds:e+i,timerStartTs:r,timerRunning:!0}}else t={...t,timerSeconds:e,timerStartTs:null,timerRunning:!1}}return t});o(i(t.deductions??[])),c(i(t.gains??[])),b(!0)}).catch(()=>{b(!0)}),()=>{e=!1}},[p,M]),(0,r.useEffect)(()=>{h&&p&&(0,n.savePersistedState)(p,e,l)},[e,l,h,p]);let B=()=>{k.current&&(window.clearTimeout(k.current),k.current=null),v(!1)},G={display:"grid",gridTemplateColumns:"1fr auto",alignItems:"center",gap:"8px",padding:"8px 10px",borderBottom:"1px solid #1f2937"},H=(e,r)=>{let a=g(e),n=!!e.criteria&&e.criteria.length>0,l="targetGains"===e.categoryKey&&"gain"===e.scoreType,s=l&&D===e.id,d=f(e.timerSeconds??0);return(0,t.jsxs)("div",{style:G,className:`${i.default.entry} ${e.justAdded?i.default.entryHighlight:""}`,children:[(0,t.jsx)("span",{style:{fontWeight:500,fontSize:"14px",color:"#e5e7eb"},children:e.name}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l&&(0,t.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"4px 8px",borderRadius:"6px",border:"1px solid #1f2937",background:s?"#0b1220":"#111827",color:s?"#e5e7eb":"#94a3b8",fontSize:"12px"},children:[(0,t.jsx)("span",{style:{fontVariantNumeric:"tabular-nums",fontWeight:600},children:d}),s&&M&&e.timerRunning&&(0,t.jsx)("button",{onClick:()=>{var t;return t=e.id,void c(e=>e.map(e=>{if(e.id!==t||"targetGains"!==e.categoryKey||!e.timerRunning)return e;let r=Date.now(),i=e.timerStartTs?Math.max(0,Math.floor((r-e.timerStartTs)/1e3)):0;return{...e,timerSeconds:(e.timerSeconds??0)+i,timerRunning:!1,timerStartTs:null,timerPaused:!0}}))},style:{border:"none",background:"transparent",color:"#e5e7eb",cursor:"pointer",fontSize:"14px",lineHeight:1},"aria-label":"Pause timer",children:"â¸"}),s&&M&&!e.timerRunning&&(0,t.jsx)("button",{onClick:()=>{var t;w(t=e.id),c(e=>e.map(e=>e.id!==t||"targetGains"!==e.categoryKey||e.timerRunning?e:{...e,timerRunning:!0,timerStartTs:Date.now(),timerPaused:!1}))},style:{border:"none",background:"transparent",color:"#e5e7eb",cursor:"pointer",fontSize:"14px",lineHeight:1},"aria-label":"Resume timer",children:"â–¶"})]}),l&&(0,t.jsx)("button",{onClick:()=>{M&&("deduction"===r?o(t=>t.map(t=>t.id===e.id?{...t,bonusActive:!t.bonusActive}:t)):c(t=>t.map(t=>t.id===e.id?{...t,bonusActive:!t.bonusActive}:t)))},style:{border:"none",background:M?e.bonusActive?"#2d1a1e":"#113227":"#1f2937",color:M?e.bonusActive?"#fca5a5":"#6ee7b7":"#64748b",padding:"4px 8px",borderRadius:"4px",cursor:M?"pointer":"not-allowed",fontWeight:600,fontSize:"12px"},disabled:!M,"aria-label":"Toggle bonus",children:e.bonusActive?"âœ•":"+10"}),n?(0,t.jsxs)("div",{style:{position:"relative",display:"inline-flex",alignItems:"center"},children:[(0,t.jsx)("select",{value:e.selectedIndex??0,onChange:t=>{var i,a;return i=e.id,a=parseInt(t.target.value,10),void("deduction"===r?o(e=>e.map(e=>e.id===i?{...e,selectedIndex:a}:e)):c(e=>e.map(e=>e.id===i?{...e,selectedIndex:a}:e)))},style:{fontSize:"12px",padding:"4px 28px 4px 8px",borderRadius:"4px",border:"none",backgroundColor:M?"#113227":"#1f2937",color:M?"#6ee7b7":"#64748b",fontWeight:500,cursor:M?"pointer":"not-allowed",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",outline:"none"},disabled:!M,children:e.criteria.map((r,i)=>(0,t.jsxs)("option",{value:i,children:[r.score," pts"]},`${e.id}-opt-${i}`))}),(0,t.jsx)("span",{style:{position:"absolute",right:"8px",pointerEvents:"none",color:"#e5e7eb",fontSize:"12px"},children:"â–¾"})]}):(0,t.jsx)(x,{value:a}),(0,t.jsx)("button",{onClick:()=>{M&&("deduction"===r?o(t=>t.filter(t=>t.id!==e.id)):c(t=>t.filter(t=>t.id!==e.id)))},style:{border:"none",background:"transparent",color:M?"#94a3b8":"#64748b",cursor:M?"pointer":"not-allowed",fontSize:"12px",padding:"2px 6px"},disabled:!M,"aria-label":"Remove item",children:"âœ•"})]})]},`${r}-${e.id}`)};return(0,t.jsxs)("div",{className:i.default.section,style:{border:"2px dashed #2d3b55",borderRadius:"8px",padding:"16px",minHeight:"360px",backgroundColor:"#0f1625",color:"#e5e7eb",boxShadow:"0 6px 20px rgba(0,0,0,0.35)"},onDragOver:e=>{e.preventDefault()},onDrop:e=>{if(e.preventDefault(),!M)return;let t=e.dataTransfer.getData("application/json");if(t||(t=e.dataTransfer.getData("text/plain")),t)try{let e=JSON.parse(t),r={id:e.id,name:e.name,scoreType:e.scoreType,criteria:e.criteria,baseType:e.baseType,fixedScore:e.score,selectedIndex:0,categoryKey:e.categoryKey,bonusActive:!1,timerSeconds:0,timerRunning:!1,timerStartTs:null,timerPaused:!1};"deduction"===r.scoreType?o(e=>{if(e.some(e=>e.id===r.id))return e;let t={...r,justAdded:!0};return setTimeout(()=>{o(e=>e.map(e=>e.id===t.id?{...e,justAdded:!1}:e))},950),[...e,t]}):c(e=>{if(e.some(e=>e.id===r.id))return e;let t=Date.now(),i={...r,justAdded:!0,timerRunning:!0,timerStartTs:t},a=[...e.map(e=>"targetGains"===e.categoryKey?{...e,timerRunning:!1,timerStartTs:null,timerPaused:!1}:e),i];return setTimeout(()=>{c(e=>e.map(e=>e.id===i.id?{...e,justAdded:!1}:e))},950),a})}catch(e){}},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[(0,t.jsx)("div",{className:i.default.dateChip,onClick:()=>j(!0),style:{cursor:"pointer"},role:"button",tabIndex:0,title:"Click to select date",children:(e=>{if(!e)return"";let[t,r,i]=e.split("-");return`${t}-${r}-${i}`})(p)||"â€”"}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[!M&&(0,t.jsx)("span",{style:{background:"#1f2937",color:"#94a3b8",border:"1px solid #334155",padding:"4px 8px",borderRadius:"6px",fontSize:"12px"},children:"ðŸ”’ locked"}),!R()&&(0,t.jsx)("button",{onClick:()=>{N(new Date().toISOString().slice(0,10))},style:{background:"transparent",border:"1px solid #334155",color:"#94a3b8",padding:"4px 8px",borderRadius:"6px",fontSize:"12px",cursor:"pointer",transition:"all 120ms ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(59, 130, 246, 0.1)",e.currentTarget.style.color="#3b82f6",e.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#94a3b8",e.currentTarget.style.borderColor="#334155"},"aria-label":"Return to today",children:"current"}),(0,t.jsx)("div",{style:{color:"#94a3b8",fontSize:"12px"},children:"daily record"})]})]}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1px 1fr",gap:"16px"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontWeight:600,marginBottom:"8px",color:"#e5e7eb"},children:"Deductions"}),0===e.length?(0,t.jsx)("div",{style:{color:"#94a3b8",fontSize:"12px"},children:M?"Drop items here":"Read-only"}):e.map(e=>H(e,"deduction"))]}),(0,t.jsx)("div",{style:{backgroundColor:"#1f2937",width:"1px"}}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontWeight:600,marginBottom:"8px",color:"#e5e7eb"},children:"Gains"}),$>0&&(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",alignItems:"center",gap:"8px",padding:"8px 10px",borderBottom:"1px solid #1f2937",backgroundColor:"rgba(34, 197, 94, 0.08)",borderRadius:"4px",marginBottom:"4px"},children:[(0,t.jsx)("span",{style:{fontWeight:500,fontSize:"14px",color:"#6ee7b7"},children:"focus"}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,t.jsx)("span",{style:{fontVariantNumeric:"tabular-nums",fontSize:"12px",color:"#94a3b8"},children:f($)}),(0,t.jsxs)("span",{style:{backgroundColor:"#113227",color:"#6ee7b7",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:500},children:[T," pts"]})]})]}),0===l.length?(0,t.jsx)("div",{style:{color:"#94a3b8",fontSize:"12px"},children:M?"Drop items here":"Read-only"}):l.map(e=>H(e,"gain"))]})]}),(0,t.jsxs)("div",{style:{marginTop:"12px",borderTop:"1px solid #1f2937",paddingTop:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)("span",{style:{color:"#94a3b8",fontSize:"12px"},children:"Total"}),(0,t.jsx)(x,{value:l.reduce((e,t)=>e+g(t),0)-e.reduce((e,t)=>e+g(t),0)})]}),(0,t.jsx)("button",{className:`${i.default.clearButton} ${S?i.default.clearButtonActive:""}`,onPointerDown:()=>{k.current&&window.clearTimeout(k.current),v(!0),k.current=window.setTimeout(()=>{k.current=null,o([]),c([]),p&&(0,n.clearPersistedState)(p),v(!1)},3e3)},onPointerUp:B,onPointerLeave:B,onPointerCancel:B,disabled:!M,"aria-label":"Clear all dropped items",children:"Clear"}),_&&(0,t.jsx)(s,{selectedDate:p,onDateSelect:N,onClose:()=>j(!1)})]})}e.s(["default",()=>h],60057)},88797,e=>{e.v({heatmap:"HistoryHeatmap-module__vd62ca__heatmap",legend:"HistoryHeatmap-module__vd62ca__legend",legendBox:"HistoryHeatmap-module__vd62ca__legendBox",row:"HistoryHeatmap-module__vd62ca__row",tile:"HistoryHeatmap-module__vd62ca__tile",tileFuture:"HistoryHeatmap-module__vd62ca__tileFuture",tileLevel1:"HistoryHeatmap-module__vd62ca__tileLevel1",tileLevel2:"HistoryHeatmap-module__vd62ca__tileLevel2",tileLevel3:"HistoryHeatmap-module__vd62ca__tileLevel3"})},70030,e=>{"use strict";var t=e.i(43476),r=e.i(71645),i=e.i(88797),a=e.i(55167),n=e.i(32833);function o(e){if(e.criteria&&e.criteria.length>0){let t=Math.max(0,e.selectedIndex??0);return(e.criteria[t]?.score??0)+10*!!e.bonusActive}return(e.fixedScore??0)+10*!!e.bonusActive}function l({onDateSelect:e}){let[l,s]=(0,r.useState)([]),{setSelectedDate:d}=(0,n.useSelectedDate)();return(0,r.useEffect)(()=>{let e=!0,t=new Date;return(0,a.listAllStates)().then(r=>{if(!e)return;let i=new Map;r.forEach(({dateKey:e,state:t})=>{i.set(e,(t.gains??[]).reduce((e,t)=>e+o(t),0)-(t.deductions??[]).reduce((e,t)=>e+o(t),0))});let a=[];for(let e=69;e>=0;e-=1){let r=new Date(t);r.setDate(t.getDate()-e);let n=r.toISOString().slice(0,10);a.push({dateKey:n,score:i.get(n)??0,isFuture:!1})}for(let e=1;e<=14;e+=1){let r=new Date(t);r.setDate(t.getDate()+e);let i=r.toISOString().slice(0,10);a.push({dateKey:i,score:0,isFuture:!0})}s(a)}),()=>{e=!1}},[]),(0,t.jsx)("div",{className:i.default.heatmap,children:l.map(r=>(0,t.jsx)("div",{className:r.isFuture?`${i.default.tile} ${i.default.tileFuture}`:r.score>=100?`${i.default.tile} ${i.default.tileLevel3}`:r.score>=50?`${i.default.tile} ${i.default.tileLevel2}`:r.score>=25?`${i.default.tile} ${i.default.tileLevel1}`:i.default.tile,title:`${r.dateKey} \xb7 ${r.score} pts${r.isFuture?" Â· upcoming":""}`,onClick:()=>{r.isFuture||(e?e(r.dateKey):d(r.dateKey))},role:r.isFuture?void 0:"button",tabIndex:r.isFuture?void 0:0,style:{cursor:r.isFuture?"default":"pointer",transition:"all 120ms ease"}},r.dateKey))})}e.s(["default",()=>l])}]);