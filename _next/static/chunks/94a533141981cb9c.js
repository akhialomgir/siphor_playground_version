(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,5987,e=>{"use strict";var t=e.i(43476),r=e.i(71645);let a=(0,r.createContext)(void 0);function i({children:e}){let[i,n]=(0,r.useState)(new Set),[o,l]=(0,r.useState)(0),[s,d]=(0,r.useState)({goals:{}}),[c,u]=(0,r.useState)(0),p=(0,r.useCallback)(e=>{n(t=>{if(t.size!==e.length)return new Set(e);for(let r of e)if(!t.has(r))return new Set(e);return t})},[]),x=(0,r.useCallback)(()=>l(e=>e+1),[]),g=(0,r.useCallback)(()=>u(e=>e+1),[]),m=(0,r.useMemo)(()=>({selectedIds:i,replaceAll:p,weeklyGoalsVersion:o,notifyWeeklyGoalsUpdate:x,weeklyGoalsState:s,setWeeklyGoalsState:d,bountyVersion:c,notifyBountyUpdate:g}),[i,p,o,x,s,c,g]);return(0,t.jsx)(a.Provider,{value:m,children:e})}function n(){let e=(0,r.useContext)(a);if(!e)throw Error("useDroppedItems must be used within DroppedItemsProvider");return e}e.s(["DroppedItemsProvider",()=>i,"useDroppedItems",()=>n])},32833,e=>{"use strict";var t=e.i(43476),r=e.i(71645);let a=(0,r.createContext)(void 0);function i({children:e}){let[i,n]=(0,r.useState)(()=>new Date().toISOString().slice(0,10));return(0,t.jsx)(a.Provider,{value:{selectedDate:i,setSelectedDate:n},children:e})}function n(){let e=(0,r.useContext)(a);if(!e)throw Error("useSelectedDate must be used within DateProvider");return e}e.s(["DateProvider",()=>i,"useSelectedDate",()=>n])},89050,55167,e=>{"use strict";var t=e.i(37372);function r(e){let r,a=(r=t.default.regularGains.items.find(e=>"focus"===e.name),r?.criteria??[]);for(let t=a.length-1;t>=0;t--)if(e>=a[t].time)return a[t].score;return 0}function a(){let e=[];return Object.values(t.default).forEach(t=>{t&&"object"==typeof t&&"items"in t&&Array.isArray(t.items)&&t.items.forEach(t=>{t.goals&&Array.isArray(t.goals)&&t.goals.forEach(r=>{"weekly"===r.type&&e.push({id:r.id,name:t.name,type:r.type,targetCount:r.targetCount,rewardPoints:r.rewardPoints,segmentCount:r.targetCount})})})}),e}function i(e){return a().find(t=>t.id===e)}function n(e){let t,r,a,i=new Date(`${e}T00:00:00`),n=i.getDay(),o=new Date(i);o.setDate(i.getDate()-n);let l=(t=o.getFullYear(),r=String(o.getMonth()+1).padStart(2,"0"),a=String(o.getDate()).padStart(2,"0"),`${t}-${r}-${a}`);return`week-${l}`}e.s(["getFocusScore",()=>r,"getWeekKey",()=>n,"getWeeklyGoalById",()=>i,"getWeeklyGoals",()=>a],89050);let o="entries",l="weeklyGoals",s="weeklyBounties",d="totalScores",c="bank",u="state";function p(){return new Promise((e,t)=>{if(!window.indexedDB)return void t(Error("IndexedDB not available"));let r=indexedDB.open("dragDropBox",5);r.onupgradeneeded=e=>{let t=r.result,a=e.oldVersion??0;t.objectStoreNames.contains(o)||t.createObjectStore(o),a<2&&!t.objectStoreNames.contains(l)&&t.createObjectStore(l),a<3&&!t.objectStoreNames.contains(d)&&t.createObjectStore(d),a<4&&!t.objectStoreNames.contains(c)&&t.createObjectStore(c),a<5&&!t.objectStoreNames.contains(s)&&t.createObjectStore(s)},r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error??Error("Failed to open IndexedDB"))})}async function x(e){try{let t=await p();return await new Promise((r,a)=>{let i=t.transaction(o,"readonly").objectStore(o).get(e);i.onsuccess=()=>{let e=i.result??{deductions:[],gains:[]};r({deductions:e.deductions??[],gains:e.gains??[]})},i.onerror=()=>a(i.error??Error("Read failed"))})}catch(e){return{deductions:[],gains:[]}}}async function g(){try{let e=await p();return await new Promise((t,r)=>{let a=e.transaction(c,"readonly").objectStore(c).get(u);a.onsuccess=()=>{let e=a.result??{demand:0,fixed:[]};t({demand:e.demand??0,fixed:e.fixed??[]})},a.onerror=()=>r(a.error??Error("Read failed"))})}catch(e){return{demand:0,fixed:[]}}}async function m(e){try{let t=await p();await new Promise((r,a)=>{let i=t.transaction(c,"readwrite").objectStore(c).put(e,u);i.onsuccess=()=>r(),i.onerror=()=>a(i.error??Error("Write failed"))})}catch(e){}}async function f(e){try{let t=await p();return await new Promise((r,a)=>{let i=t.transaction(s,"readonly").objectStore(s).get(e);i.onsuccess=()=>{let e=i.result??{items:[]};r({items:e.items??[]})},i.onerror=()=>a(i.error??Error("Read failed"))})}catch(e){return{items:[]}}}async function b(e,t){try{let r=await p();await new Promise((a,i)=>{let n=r.transaction(s,"readwrite").objectStore(s).put(t,e);n.onsuccess=()=>a(),n.onerror=()=>i(n.error??Error("Write failed"))})}catch(e){}}async function y(e,t,r){let a=t.trim();if(!a||!Number.isFinite(r)||r<=0)return await f(e);let i=await f(e),n={id:`bounty-${Date.now()}-${Math.random().toString(16).slice(2)}`,title:a,points:r,completedDate:null,createdAt:new Date().toISOString()},o={items:[...i.items,n]};return await b(e,o),o}async function h(e,t,r){let a={items:(await f(e)).items.map(e=>{if(e.id!==t)return e;let a=e.completedDate===r;return{...e,completedDate:a?null:r}})};return await b(e,a),a}async function S(e){let t=n(e);return(await f(t)).items.reduce((t,r)=>t+(r.completedDate===e?r.points??0:0),0)}async function w(e,t,r){try{let a=await p();await new Promise((i,n)=>{let l=a.transaction(o,"readwrite").objectStore(o).put({deductions:t,gains:r},e);l.onsuccess=()=>i(),l.onerror=()=>n(l.error??Error("Write failed"))})}catch(e){}}async function v(e){try{let t=await p();await new Promise((r,a)=>{let i=t.transaction(o,"readwrite").objectStore(o).delete(e);i.onsuccess=()=>r(),i.onerror=()=>a(i.error??Error("Delete failed"))})}catch(e){}}async function j(){try{let e=await p();return await new Promise((t,r)=>{let a=e.transaction(o,"readonly").objectStore(o),i=a.getAllKeys();i.onsuccess=async()=>{let e=i.result.filter(Boolean),n=[],o=e.map(e=>new Promise((t,r)=>{let i=a.get(e);i.onsuccess=()=>{let r=i.result??{deductions:[],gains:[]};n.push({dateKey:e,state:r}),t()},i.onerror=()=>r(i.error??Error("Read failed"))}));try{await Promise.all(o),t(n)}catch(e){r(e)}},i.onerror=()=>r(i.error??Error("List keys failed"))})}catch(e){return[]}}async function k(){try{let e=await p();return await new Promise((t,r)=>{let a=e.transaction(l,"readonly").objectStore(l),i=a.getAllKeys();i.onsuccess=async()=>{let e=i.result.filter(Boolean),n=[],o=e.map(e=>new Promise((t,r)=>{let i=a.get(e);i.onsuccess=()=>{let r=i.result??{goals:{}};n.push({weekKey:e,state:{goals:r.goals??{}}}),t()},i.onerror=()=>r(i.error??Error("Read failed"))}));try{await Promise.all(o),t(n)}catch(e){r(e)}},i.onerror=()=>r(i.error??Error("List keys failed"))})}catch(e){return[]}}async function D(){try{let e=await p();return await new Promise((t,r)=>{let a=e.transaction(s,"readonly").objectStore(s),i=a.getAllKeys();i.onsuccess=async()=>{let e=i.result.filter(Boolean),n=[],o=e.map(e=>new Promise((t,r)=>{let i=a.get(e);i.onsuccess=()=>{let r=i.result??{items:[]};n.push({weekKey:e,state:{items:r.items??[]}}),t()},i.onerror=()=>r(i.error??Error("Read failed"))}));try{await Promise.all(o),t(n)}catch(e){r(e)}},i.onerror=()=>r(i.error??Error("List keys failed"))})}catch(e){return[]}}async function T(){let e=await j(),t=await k(),r=await D(),a=await g(),i=await R();return{version:"1.0",exportDate:new Date().toISOString(),data:e,weeklyGoals:t,weeklyBounties:r,bankState:a,totalScoreHistory:i}}async function C(e){if(!e.version||!Array.isArray(e.data))throw Error("Invalid import data format");let t=await p();for(let{dateKey:r,state:a}of e.data)await new Promise((e,i)=>{let n=t.transaction(o,"readwrite").objectStore(o).put(a,r);n.onsuccess=()=>e(),n.onerror=()=>i(n.error??Error("Write failed"))});for(let{weekKey:r,state:a}of e.weeklyGoals??[])await new Promise((e,i)=>{let n=t.transaction(l,"readwrite").objectStore(l).put(a,r);n.onsuccess=()=>e(),n.onerror=()=>i(n.error??Error("Write failed"))});for(let{weekKey:r,state:a}of e.weeklyBounties??[])await new Promise((e,i)=>{let n=t.transaction(s,"readwrite").objectStore(s).put(a,r);n.onsuccess=()=>e(),n.onerror=()=>i(n.error??Error("Write failed"))});e.bankState&&await m(e.bankState),e.totalScoreHistory&&await $(e.totalScoreHistory)}let _="history";async function R(){try{let e=await p();return await new Promise((t,r)=>{let a=e.transaction(d,"readonly").objectStore(d).get(_);a.onsuccess=()=>{let e=a.result??{};t(e)},a.onerror=()=>r(a.error??Error("Read failed"))})}catch(e){return{}}}async function $(e){try{let t=await p();await new Promise((r,a)=>{let i=t.transaction(d,"readwrite").objectStore(d).put(e,_);i.onsuccess=()=>r(),i.onerror=()=>a(i.error??Error("Write failed"))})}catch(e){}}function I(e){return(e.gains??[]).reduce((e,t)=>{if("gain"!==t.scoreType)return e;if(t.criteria&&t.criteria.length>0){let r=Math.max(0,t.selectedIndex??0);return e+(t.criteria[r]?.score??0)+10*!!t.bonusActive}return e+(t.fixedScore??0)+10*!!t.bonusActive},0)+(e.deductions??[]).reduce((e,t)=>{if("deduction"!==t.scoreType)return e;if(void 0!==t.fixedScore)return e-Math.abs(t.fixedScore*(t.count??1));if(t.criteria&&t.criteria.length>0&&"duration"===t.baseType){let r=t.criteria[0];if(r&&void 0!==t.timerSeconds)return e-Math.ceil(r.score/r.time*t.timerSeconds)}return void 0!==t.customScore?e-Math.abs(t.customScore):e},0)}async function M(e){let t=await j(),r={"1970-01-01":e},a=e;if(0===t.length)return await $(r),r;for(let{dateKey:e,state:i}of t.sort((e,t)=>e.dateKey.localeCompare(t.dateKey)))a+=I(i)+await S(e),r[e]=a;return await $(r),r}async function W(){let e=await j();if(0===e.length)return{"1970-01-01":0};let t=e.sort((e,t)=>e.dateKey.localeCompare(t.dateKey)),r={"1970-01-01":0},a=0;for(let{dateKey:e,state:i}of t)a+=I(i)+await S(e),r[e]=a;return await $(r),r}async function A(e){let t=await R();return Object.keys(t).length<=1?E(await W(),e):E(t,e)}function E(e,t){let r=new Date(new Date(t));r.setDate(r.getDate()-1);let a=r.toISOString().slice(0,10);if(void 0!==e[a])return e[a];let i=Object.keys(e).sort(),n=0;for(let t of i)if(t<=a)n=e[t];else break;return n}async function N(e,t){let r=await R(),a=new Date(new Date(e));a.setDate(a.getDate()-1),a.toISOString().slice(0,10);let i=E(r,e);r[e]=i+t,await $(r)}e.s(["addWeeklyBounty",()=>y,"clearPersistedState",()=>v,"exportAllData",()=>T,"getBountyPointsForDate",()=>S,"getTotalScoreUpToDate",()=>A,"importAllData",()=>C,"listAllStates",()=>j,"loadBankState",()=>g,"loadPersistedState",()=>x,"loadWeeklyBounties",()=>f,"rebuildTotalScoreHistory",()=>M,"saveBankState",()=>m,"savePersistedState",()=>w,"toggleWeeklyBounty",()=>h,"updateTotalScoreForDate",()=>N],55167)},24335,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(37372),i=e.i(5987),n=e.i(32833),o=e.i(55167);function l(){let[e,l]=(0,r.useState)(null),[s,d]=(0,r.useState)({}),[c,u]=(0,r.useState)({}),{selectedIds:p,weeklyGoalsState:x}=(0,i.useDroppedItems)(),{selectedDate:g}=(0,n.useSelectedDate)();if((0,r.useEffect)(()=>{l(a.default)},[]),(0,r.useEffect)(()=>{x&&x.goals&&d(x.goals)},[x,p,g]),(0,r.useEffect)(()=>{let e=!1,t=g||new Date().toISOString().slice(0,10),r=new Date(`${t}T00:00:00`).getTime();return(0,o.listAllStates)().then(t=>{let a={};t.forEach(({dateKey:e,state:t})=>{(t.gains??[]).forEach(t=>{if("targetGains"!==t.categoryKey)return;let r=a[t.id];(!r||e>r)&&(a[t.id]=e)})});let i={};Object.entries(a).forEach(([e,t])=>{i[e]=Math.max(0,Math.floor((r-new Date(`${t}T00:00:00`).getTime())/864e5))}),p.forEach(e=>{e.startsWith("targetGains-")&&(i[e]=0)}),e||u(i)}).catch(()=>{e||u({})}),()=>{e=!0}},[g,p]),!e)return(0,t.jsx)("div",{children:"Loading..."});let m={padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:500},f={pts:{backgroundColor:"#113227",color:"#6ee7b7"},time:{backgroundColor:"#10233d",color:"#93c5fd"}},b=({variant:e,children:r})=>(0,t.jsx)("span",{style:{...m,...f[e]},children:r}),y=({children:e})=>(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"6px"},children:e});return(0,t.jsx)("div",{style:{padding:"20px",fontFamily:"system-ui, -apple-system, sans-serif",backgroundColor:"#0b1220",color:"#e5e7eb"},children:(0,t.jsx)("div",{style:{display:"grid",gap:"20px"},children:Object.entries(e).map(([e,r])=>{let a="targetGains"===e?[...r.items].sort((t,r)=>{let a=`${e}-${t.id}`,i=`${e}-${r.id}`,n=c[a]??1/0,o=c[i]??1/0;return n===o?t.name.localeCompare(r.name):o-n}):r.items;return(0,t.jsxs)("div",{style:{border:"2px solid #243046",borderRadius:"8px",overflow:"hidden",backgroundColor:"#0f1625",boxShadow:"0 6px 20px rgba(0,0,0,0.35)"},children:[(0,t.jsxs)("div",{style:{backgroundColor:"#111827",padding:"12px 16px",borderBottom:"2px solid #243046",fontWeight:600,fontSize:"16px",color:"#e5e7eb"},children:[{deductions:"Deductions",regularGains:"Regular Gains",targetGains:"Target Gains"}[e]||e,(0,t.jsxs)("span",{style:{marginLeft:"12px",fontSize:"12px",color:"#94a3b8"},children:["(","gain"===r.scoreType?"Gain":"Deduction",")"]})]}),(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px",padding:"8px"},children:a.map((a,i)=>{let n=a.criteria&&a.criteria.length>0,o=(e=>{if(!e.criteria||0===e.criteria.length)return null;let r=e.criteria.map((r,a)=>{let i="";if("duration"===e.baseType){var n;let e,t;e=Math.floor((n=r.time)/3600),t=Math.floor(n%3600/60),i=e>0?t>0?`${e}h${t}m`:`${e}h`:`${t}m`}else if("relativeTime"===e.baseType){let e=new Date(0);e.setSeconds(r.time);let t=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1});i=`${r.comparison} ${t}`}return(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"8px"},children:[i&&(0,t.jsx)(b,{variant:"time",children:i}),(0,t.jsxs)(b,{variant:"pts",children:[r.score," pts"]})]},`${e.id}-crit-${a}-${r.time}-${r.score}`)});if(r.length>2){let a=[];for(let i=0;i<r.length;i+=2){let n=r.slice(i,i+2);a.push((0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"6px"},children:n},`crit-col-${e.id}-${i}`))}return(0,t.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",flexWrap:"wrap",gap:"8px"},children:a})}return(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"6px"},children:r})})(a),l=`${e}-${a.id}`,d=p.has(l),u=c[l],x="targetGains"===e&&!d,g=void 0===u?"No record":0===u?"Today":`${u} days ago`,m=a.goals?.find(e=>"weekly"===e.type),f=m?.id,h=f&&s[f]?s[f]:void 0,S=m?m.targetCount:0,w=m?Math.min(h?.count??0,m.targetCount):0;return(0,t.jsxs)("div",{draggable:!0,onDragStart:t=>{let i={id:`${e}-${a.id}`,name:a.name,scoreType:"gain"===r.scoreType?"gain":"deduction",score:a.score,criteria:a.criteria??[],baseType:a.baseType,categoryKey:e,weeklyGoalId:f};t.dataTransfer.setData("application/json",JSON.stringify(i))},style:{border:"1px solid #1f2937",borderRadius:"6px",backgroundColor:"#111827",padding:"8px 12px",display:"grid",gridTemplateColumns:"1fr auto",rowGap:"4px",columnGap:"6px",...d?{backgroundColor:"rgba(110, 231, 183, 0.14)",outline:"1px solid rgba(110, 231, 183, 0.28)",borderRadius:"6px"}:{}},children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{style:{marginBottom:n?"6px":"0"},children:[(0,t.jsx)("span",{style:{fontWeight:500,fontSize:"13px",color:"#e5e7eb"},children:a.name}),(0,t.jsxs)("span",{style:{marginLeft:"6px",color:"#94a3b8",fontSize:"11px"},children:["(ID: ",a.id,")"]})]}),x&&(0,t.jsx)("span",{style:{backgroundColor:"#1f2937",padding:"2px 6px",borderRadius:"3px",fontSize:"11px",color:"#cbd5e1",whiteSpace:"nowrap"},children:g})]}),(0,t.jsxs)(y,{children:["number"==typeof a.score&&(0,t.jsxs)(b,{variant:"pts",children:[a.score," pts"]}),m&&(0,t.jsxs)(b,{variant:"pts",children:[m.rewardPoints," pts"]}),o]}),m&&S>0&&(0,t.jsxs)("div",{style:{gridColumn:"1 / -1",display:"flex",alignItems:"center",gap:"6px",justifyContent:"flex-start",minWidth:0},children:[(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:`repeat(${S}, 1fr)`,gap:"4px",flex:1,minWidth:0,maxWidth:"260px"},children:Array.from({length:S}).map((e,r)=>{let i=r<w;return(0,t.jsx)("div",{style:{height:"6px",borderRadius:"4px",background:i?"#22c55e":"#1f2937",border:"1px solid #1f2937"}},`${a.id}-seg-${r}`)})}),(0,t.jsxs)("span",{style:{color:"#cbd5e1",fontSize:"11px",whiteSpace:"nowrap",marginLeft:"6px",flexShrink:0},children:[w,"/",m.targetCount]})]})]},a.id)})})]},e)})})})}e.s(["default",()=>l])},89431,e=>{e.v({"clear-wiggle":"DragDropBox-module__HXSG-G__clear-wiggle",clearButton:"DragDropBox-module__HXSG-G__clearButton",clearButtonActive:"DragDropBox-module__HXSG-G__clearButtonActive",dateChip:"DragDropBox-module__HXSG-G__dateChip",entry:"DragDropBox-module__HXSG-G__entry","entry-glow":"DragDropBox-module__HXSG-G__entry-glow",entryHighlight:"DragDropBox-module__HXSG-G__entryHighlight",section:"DragDropBox-module__HXSG-G__section"})},36999,e=>{e.v({calendarContainer:"Calendar-module__rMASNW__calendarContainer",calendarHeader:"Calendar-module__rMASNW__calendarHeader",calendarOverlay:"Calendar-module__rMASNW__calendarOverlay",day:"Calendar-module__rMASNW__day",days:"Calendar-module__rMASNW__days",empty:"Calendar-module__rMASNW__empty",fadeIn:"Calendar-module__rMASNW__fadeIn",future:"Calendar-module__rMASNW__future",hasData:"Calendar-module__rMASNW__hasData",monthYear:"Calendar-module__rMASNW__monthYear",navButton:"Calendar-module__rMASNW__navButton",noData:"Calendar-module__rMASNW__noData",selected:"Calendar-module__rMASNW__selected",slideUp:"Calendar-module__rMASNW__slideUp",weekday:"Calendar-module__rMASNW__weekday",weekdays:"Calendar-module__rMASNW__weekdays"})},60057,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(89431),i=e.i(5987),n=e.i(55167),o=e.i(36999);function l(e){if(e.criteria&&e.criteria.length>0){let t=Math.max(0,e.selectedIndex??0);return(e.criteria[t]?.score??0)+10*!!e.bonusActive}return(e.fixedScore??0)+10*!!e.bonusActive}function s({selectedDate:e,onDateSelect:a,onClose:i}){let[s,d]=(0,r.useState)(()=>{let[t,r,a]=e.split("-").map(Number);return new Date(t,r-1,a)}),[c,u]=(0,r.useState)(new Set);(0,r.useEffect)(()=>{(0,n.listAllStates)().then(e=>{let t=new Set;e.forEach(({dateKey:e,state:r})=>{0!=(r.gains??[]).reduce((e,t)=>e+l(t),0)-(r.deductions??[]).reduce((e,t)=>e+l(t),0)&&t.add(e)}),u(t)})},[]);let p=s.getFullYear(),x=s.getMonth(),g=new Date(p,x,1),m=new Date(p,x+1,0).getDate(),f=g.getDay(),b=[];for(let e=0;e<f;e++)b.push(null);for(let e=1;e<=m;e++)b.push(e);let y=new Intl.DateTimeFormat("en-US",{month:"long"}).format(s),h=e=>{let t=`${p}-${String(x+1).padStart(2,"0")}-${String(e).padStart(2,"0")}`;return c.has(t)},S=e=>{let t=new Date(p,x,e),r=new Date;return r.setHours(0,0,0,0),t>r};return(0,t.jsx)("div",{className:o.default.calendarOverlay,onClick:i,children:(0,t.jsxs)("div",{className:o.default.calendarContainer,onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:o.default.calendarHeader,children:[(0,t.jsx)("button",{onClick:()=>{d(new Date(p,x-1,1))},className:o.default.navButton,"aria-label":"Previous month",children:"â€¹"}),(0,t.jsxs)("div",{className:o.default.monthYear,children:[y," ",p]}),(0,t.jsx)("button",{onClick:()=>{d(new Date(p,x+1,1))},className:o.default.navButton,"aria-label":"Next month",children:"â€º"})]}),(0,t.jsx)("div",{className:o.default.weekdays,children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,t.jsx)("div",{className:o.default.weekday,children:e},e))}),(0,t.jsx)("div",{className:o.default.days,children:b.map((r,n)=>(0,t.jsx)("div",{className:`${o.default.day} ${null===r?o.default.empty:""} ${r&&`${p}-${String(x+1).padStart(2,"0")}-${String(r).padStart(2,"0")}`===e?o.default.selected:""} ${r&&h(r)?o.default.hasData:""} ${r&&S(r)?o.default.future:""} ${r&&!h(r)&&!S(r)?o.default.noData:""}`,onClick:()=>null!==r&&void(a(`${p}-${String(x+1).padStart(2,"0")}-${String(r).padStart(2,"0")}`),i()),role:null!==r?"button":void 0,tabIndex:null!==r?0:void 0,children:r},n))})]})})}var d=e.i(32833),c=e.i(89050),u=e.i(37372);let p={padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:500},x={backgroundColor:"#113227",color:"#6ee7b7"},g={...p,backgroundColor:"#0d1b2f",color:"#cbd5e1",border:"1px solid #1f2937"},m=({value:e})=>(0,t.jsxs)("span",{style:{...p,...x},children:[e," pts"]});function f(e){if("deduction"===e.scoreType){if(void 0!==e.fixedScore)return-Math.abs(e.fixedScore*(e.count??1));if(e.criteria&&e.criteria.length>0&&"duration"===e.baseType){let t=e.criteria[0];if(t&&void 0!==e.timerSeconds)return-Math.ceil(t.score/t.time*e.timerSeconds)}return void 0!==e.customScore?-Math.abs(e.customScore):0}if(e.criteria&&e.criteria.length>0){let t=Math.max(0,e.selectedIndex??0);return(e.criteria[t]?.score??0)+10*!!e.bonusActive+(e.weeklyRewardBonus??0)}return(e.fixedScore??0)+10*!!e.bonusActive+(e.weeklyRewardBonus??0)}function b(e){let t=Math.max(0,Math.floor(e)),r=Math.floor(t/3600),a=Math.floor(t%3600/60);return`${String(r).padStart(2,"0")}:${String(a).padStart(2,"0")}:${String(t%60).padStart(2,"0")}`}function y(e){return e.filter(e=>"targetGains"===e.categoryKey).reduce((e,t)=>e+(t.timerSeconds??0),0)}function h(e){let t=u.default.deductions.items.find(t=>t.name===e);return t?.type==="tiered"&&"duration"===t.baseType}function S(e){let t=u.default.deductions.items.find(t=>t.name===e);return t?.type==="custom"}function w(){let e,[o,l]=(0,r.useState)([]),[p,x]=(0,r.useState)([]),{selectedDate:w,setSelectedDate:v}=(0,d.useSelectedDate)(),[j,k]=(0,r.useState)(!1),[D,T]=(0,r.useState)(!1),[C,_]=(0,r.useState)(!1),[R,$]=(0,r.useState)(0),[I,M]=(0,r.useState)(0),[W,A]=(0,r.useState)(null),[E,N]=(0,r.useState)(0),[B,P]=(0,r.useState)(0),[z,G]=(0,r.useState)({demand:0,fixed:[]}),[H,K]=(0,r.useState)(!1),[O,L]=(0,r.useState)(""),[F,U]=(0,r.useState)("demand"),X=(0,r.useRef)(null),J=(0,r.useRef)(null),{replaceAll:Y,setWeeklyGoalsState:V,weeklyGoalsState:q,bountyVersion:Q}=(0,i.useDroppedItems)();J.current=Y;let Z=()=>w===new Date().toISOString().slice(0,10),ee=Z(),et=e=>{v(e),k(!1)};(0,r.useEffect)(()=>{let e=new Date().toISOString().slice(0,10);(0,n.getTotalScoreUpToDate)(w||e).then(e=>{N(e)}).catch(()=>{N(0)})},[w]),(0,r.useEffect)(()=>{w?(0,n.getBountyPointsForDate)(w).then(P).catch(()=>P(0)):P(0)},[w,Q]),(0,r.useEffect)(()=>{if(!j||!ee)return;let e=new Date().toISOString().slice(0,10),t=w||e,r=(0,c.getWeekKey)(t),a=r.replace("week-",""),i=new Date(`${a}T00:00:00`),o=new Date(i);o.setDate(o.getDate()+7),(0,n.listAllStates)().then(e=>{let a=e.map(e=>e.dateKey===t?{dateKey:e.dateKey,state:{deductions:e.state.deductions??[],gains:p}}:e);a.some(e=>e.dateKey===t)||a.push({dateKey:t,state:{deductions:[],gains:p}});let n={};(0,c.getWeeklyGoals)().forEach(e=>{let t=0,l=!1;if(a.forEach(({dateKey:a,state:n})=>{let s=new Date(`${a}T00:00:00`);if(s>=i&&s<o){let a=n.gains??[];t+=a.filter(t=>t.weeklyGoalId===e.id).length,a.some(t=>t.weeklyRewardId===`weekly-${e.id}-${r}`)&&(l=!0)}}),n[e.id]={count:t,rewarded:l},!l&&t>=e.targetCount){let t=`weekly-${e.id}-${r}`,a=p.findIndex(t=>t.weeklyGoalId===e.id&&!t.weeklyRewardId);-1!==a&&(x(r=>r.map((r,i)=>i===a?{...r,weeklyRewardId:t,weeklyRewardBonus:e.rewardPoints,justAdded:!0}:r)),n[e.id].rewarded=!0)}}),V({goals:n})}).catch(()=>V({goals:{}}))},[j,w,p,V,ee]),(0,r.useEffect)(()=>{let e=!0;return(0,n.loadBankState)().then(t=>{e&&(G({demand:t.demand??0,fixed:t.fixed??[]}),K(!0))}).catch(()=>{e&&K(!0)}),()=>{e=!1}},[]),(0,r.useEffect)(()=>{let e=new Date().toISOString().slice(0,10),t=w||e;(0,n.getTotalScoreUpToDate)(t).then(e=>N(e)).catch(()=>N(0))},[w]),(0,r.useEffect)(()=>{let e=[...o,...p].map(e=>e.id);J.current?.(e)},[o,p]),(0,r.useEffect)(()=>{if(j){if(!ee){x(e=>e.some(e=>"targetGains"===e.categoryKey&&(e.timerRunning||e.timerStartTs))?e.map(e=>"targetGains"===e.categoryKey?{...e,timerRunning:!1,timerStartTs:null}:e):e),l(e=>e.some(e=>h(e.name)&&(e.timerRunning||e.timerStartTs))?e.map(e=>h(e.name)?{...e,timerRunning:!1,timerStartTs:null}:e):e);return}x(e=>(e.filter(e=>"targetGains"===e.categoryKey).map(e=>e.id),e)),l(e=>e)}},[ee,j]),(0,r.useEffect)(()=>{if(!ee||0===p.filter(e=>"targetGains"===e.categoryKey&&e.timerRunning).map(e=>e.id).length)return;let e=window.setInterval(()=>{x(e=>{let t=Date.now(),r=!1,a=e.map(e=>{if("targetGains"!==e.categoryKey||!e.timerRunning||!e.timerStartTs)return e;let a=Math.max(0,Math.floor((t-e.timerStartTs)/1e3));return a<=0?e:(r=!0,{...e,timerSeconds:(e.timerSeconds??0)+a,timerStartTs:t})});if(r){let e=y(a);M(e),$((0,c.getFocusScore)(e))}return r?a:e})},1e3);return()=>window.clearInterval(e)},[ee,p]),(0,r.useEffect)(()=>{let e=y(p);M(e),$((0,c.getFocusScore)(e))},[p]),(0,r.useEffect)(()=>{if(!ee||0===o.filter(e=>h(e.name)&&e.timerRunning).map(e=>e.id).length)return;let e=window.setInterval(()=>{let e=Date.now();l(t=>{let r=!1,a=t.map(t=>{if(!h(t.name)||!t.timerRunning||!t.timerStartTs)return t;let a=Math.max(0,Math.floor((e-t.timerStartTs)/1e3));return a<=0?t:(r=!0,{...t,timerSeconds:(t.timerSeconds??0)+a,timerStartTs:e})});return r?a:t})},1e3);return()=>window.clearInterval(e)},[ee,o]),(0,r.useEffect)(()=>{let e=!0,t=w;return t||(t=new Date().toISOString().slice(0,10)),(0,n.loadPersistedState)(t).then(t=>{if(!e)return;let r=Date.now(),a=e=>e.map(e=>{let t={...e,justAdded:!1,timerPaused:e.timerPaused??!1};if("targetGains"===t.categoryKey){let e=t.timerSeconds??0;if(t.timerRunning&&ee&&t.timerStartTs){let a=Math.max(0,Math.floor((r-t.timerStartTs)/1e3));t={...t,timerSeconds:e+a,timerStartTs:r,timerRunning:!0}}else t={...t,timerSeconds:e,timerStartTs:null,timerRunning:!1,timerPaused:t.timerPaused??!1}}else if("deduction"===t.scoreType&&h(t.name)){let e=t.timerSeconds??0;if(t.timerRunning&&ee&&t.timerStartTs){let a=Math.max(0,Math.floor((r-t.timerStartTs)/1e3));t={...t,timerSeconds:e+a,timerStartTs:r,timerRunning:!0}}else t={...t,timerSeconds:e,timerStartTs:null,timerRunning:!1,timerPaused:t.timerPaused??!1}}return t});l(a(t.deductions??[])),x(a(t.gains??[])),k(!0)}).catch(e=>{console.error("Failed to load persisted state:",e),k(!0)}),()=>{e=!1}},[w,ee]),(0,r.useEffect)(()=>{j&&w&&(0,n.savePersistedState)(w,o,p)},[o,p,j,w]),(0,r.useEffect)(()=>{if(!j||!w)return;let e=p.reduce((e,t)=>e+f(t),0)+o.reduce((e,t)=>e+f(t),0)+B;(0,n.updateTotalScoreForDate)(w,e).catch(()=>{})},[o,p,j,w,B]);let er=()=>{X.current&&(window.clearTimeout(X.current),X.current=null),T(!1)},ea=e=>{G(t=>{let r=e(t);return(0,n.saveBankState)(r),r})},ei=(e,t)=>{"gain"===t?x(t=>t.map(t=>{if(t.id!==e||"targetGains"!==t.categoryKey||!t.timerRunning)return t;let r=Date.now(),a=t.timerStartTs?Math.max(0,Math.floor((r-t.timerStartTs)/1e3)):0;return{...t,timerSeconds:(t.timerSeconds??0)+a,timerRunning:!1,timerStartTs:null,timerPaused:!0}})):l(t=>t.map(t=>{if(t.id!==e||!h(t.name)||!t.timerRunning)return t;let r=Date.now(),a=t.timerStartTs?Math.max(0,Math.floor((r-t.timerStartTs)/1e3)):0;return{...t,timerSeconds:(t.timerSeconds??0)+a,timerRunning:!1,timerStartTs:null,timerPaused:!0}}))},en=(e,t)=>{"gain"===t?(x(t=>t.map(t=>{if("targetGains"!==t.categoryKey)return t;if(t.id===e)return t.timerRunning?t:{...t,timerRunning:!0,timerStartTs:Date.now(),timerPaused:!1};if(t.timerRunning){let e=Date.now(),r=t.timerStartTs?Math.max(0,Math.floor((e-t.timerStartTs)/1e3)):0;return{...t,timerSeconds:(t.timerSeconds??0)+r,timerRunning:!1,timerStartTs:null,timerPaused:!0}}return t})),l(e=>e.map(e=>{if(!h(e.name))return e;if(e.timerRunning){let t=Date.now(),r=e.timerStartTs?Math.max(0,Math.floor((t-e.timerStartTs)/1e3)):0;return{...e,timerSeconds:(e.timerSeconds??0)+r,timerRunning:!1,timerStartTs:null,timerPaused:!0}}return e}))):(l(t=>t.map(t=>{if(!h(t.name))return t;if(t.id===e)return t.timerRunning?t:{...t,timerRunning:!0,timerStartTs:Date.now(),timerPaused:!1};if(t.timerRunning){let e=Date.now(),r=t.timerStartTs?Math.max(0,Math.floor((e-t.timerStartTs)/1e3)):0;return{...t,timerSeconds:(t.timerSeconds??0)+r,timerRunning:!1,timerStartTs:null,timerPaused:!0}}return t})),x(e=>e.map(e=>{if("targetGains"!==e.categoryKey)return e;if(e.timerRunning){let t=Date.now(),r=e.timerStartTs?Math.max(0,Math.floor((t-e.timerStartTs)/1e3)):0;return{...e,timerSeconds:(e.timerSeconds??0)+r,timerRunning:!1,timerStartTs:null,timerPaused:!0}}return e})))},eo=(e,r)=>{var i;let n,o=f(e),s=!!e.criteria&&e.criteria.length>0,d="targetGains"===e.categoryKey&&"gain"===e.scoreType;d&&e.timerRunning;let p=b(e.timerSeconds??0),g=e.weeklyGoalId?(0,c.getWeeklyGoalById)(e.weeklyGoalId):void 0,y=g?q.goals[g.id]:void 0,w=g?g.segmentCount||g.targetCount:0;g&&(y?.count,g.targetCount);let v=g&&w>0,j="deduction"===e.scoreType&&(i=e.name,n=u.default.deductions.items.find(e=>e.name===i),n?.type==="fixed"),k="deduction"===e.scoreType&&h(e.name),D="deduction"===e.scoreType&&S(e.name),T=t=>{if(!ee)return;let r=Math.max(0,(e.count??1)+t);0===r?l(t=>t.filter(t=>t.id!==e.id)):l(t=>t.map(t=>t.id===e.id?{...t,count:r}:t))};return(0,t.jsx)("div",{style:{display:"flex",alignItems:v?"flex-start":"center",gap:"8px",rowGap:v?"6px":void 0,padding:"8px 10px",borderBottom:"1px solid #1f2937",flexWrap:v?"wrap":"nowrap"},className:`${a.default.entry} ${e.justAdded?a.default.entryHighlight:""}`,children:D?W===e.id?(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",width:"100%"},children:[(0,t.jsx)("span",{style:{fontWeight:500,fontSize:"14px",color:"#e5e7eb",minWidth:"fit-content"},children:"Expense"}),(0,t.jsx)("input",{type:"text",value:e.customDescription??"",onChange:t=>{var r;return r=t.target.value,void(ee&&l(t=>t.map(t=>t.id===e.id?{...t,customDescription:r}:t)))},placeholder:"Description",disabled:!ee,onKeyDown:e=>{if("Enter"===e.key){e.preventDefault();let t=e.currentTarget.nextElementSibling;t?.focus()}},style:{flex:1,minWidth:"100px",padding:"6px 8px",borderRadius:"4px",border:"1px solid #334155",backgroundColor:ee?"#1f2937":"#111827",color:ee?"#e5e7eb":"#64748b",fontSize:"13px",outline:"none",transition:"border-color 0.2s",cursor:ee?"text":"not-allowed"},onFocus:e=>{e.target.style.borderColor="#0ea5e9"},onBlur:e=>{e.target.style.borderColor="#334155"}}),(0,t.jsx)("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:e.customScore??0,onChange:t=>(t=>{if(!ee)return;let r=Number(t)||0;l(t=>t.map(t=>t.id===e.id?{...t,customScore:r}:t))})(t.target.value),placeholder:"0",disabled:!ee,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),A(null))},style:{width:"60px",padding:"6px 8px",borderRadius:"4px",border:"1px solid #334155",backgroundColor:ee?"#1f2937":"#111827",color:ee?"#e5e7eb":"#64748b",fontSize:"13px",outline:"none",transition:"border-color 0.2s",cursor:ee?"text":"not-allowed",textAlign:"center"},onFocus:e=>{e.target.style.borderColor="#0ea5e9"},onBlur:e=>{e.target.style.borderColor="#334155"}}),(0,t.jsx)("button",{onClick:()=>{A(null)},style:{border:"none",background:"transparent",color:ee?"#10b981":"#64748b",cursor:ee?"pointer":"not-allowed",fontSize:"14px",padding:"2px 6px",flexShrink:0},disabled:!ee,"aria-label":"Save",title:"Save changes",children:"âœ“"}),(0,t.jsx)("button",{onClick:()=>{ee&&l(t=>t.filter(t=>t.id!==e.id))},style:{border:"none",background:"transparent",color:ee?"#94a3b8":"#64748b",cursor:ee?"pointer":"not-allowed",fontSize:"12px",padding:"2px 6px",flexShrink:0},disabled:!ee,"aria-label":"Remove item",children:"âœ•"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{style:{fontWeight:500,fontSize:"14px",color:"#e5e7eb"},children:e.customDescription??"Expense"}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginLeft:"auto"},children:[(0,t.jsx)("button",{onClick:()=>{ee&&A(e.id)},style:{border:"none",background:"transparent",color:ee?"#60a5fa":"#64748b",cursor:ee?"pointer":"not-allowed",fontSize:"12px",padding:"2px 6px"},disabled:!ee,"aria-label":"Edit",title:"Edit expense",children:"âœŽ"}),(0,t.jsx)(m,{value:o}),(0,t.jsx)("button",{onClick:()=>{ee&&l(t=>t.filter(t=>t.id!==e.id))},style:{border:"none",background:"transparent",color:ee?"#94a3b8":"#64748b",cursor:ee?"pointer":"not-allowed",fontSize:"12px",padding:"2px 6px"},disabled:!ee,"aria-label":"Remove item",children:"âœ•"})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{style:{fontWeight:500,fontSize:"14px",color:"#e5e7eb",flex:"1",minWidth:"0",overflow:"hidden",textOverflow:"ellipsis"},children:e.name}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexShrink:0},children:[j&&(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,t.jsx)("button",{onClick:()=>T(-1),disabled:!ee||(e.count??1)<=1,style:{border:"1px solid #475569",background:ee&&(e.count??1)>1?"#1f2937":"#111827",color:ee&&(e.count??1)>1?"#94a3b8":"#64748b",padding:"2px 6px",borderRadius:"4px",cursor:ee&&(e.count??1)>1?"pointer":"not-allowed",fontSize:"12px",fontWeight:500},"aria-label":"Decrease count",children:"âˆ’"}),(0,t.jsx)("span",{style:{minWidth:"20px",textAlign:"center",fontSize:"12px",fontWeight:500,color:"#cbd5e1"},children:e.count??1}),(0,t.jsx)("button",{onClick:()=>T(1),disabled:!ee,style:{border:"1px solid #475569",background:ee?"#1f2937":"#111827",color:ee?"#94a3b8":"#64748b",padding:"2px 6px",borderRadius:"4px",cursor:ee?"pointer":"not-allowed",fontSize:"12px",fontWeight:500},"aria-label":"Increase count",children:"+"})]}),k&&(0,t.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"4px 8px",borderRadius:"6px",border:"1px solid #1f2937",background:"#111827",color:"#94a3b8",fontSize:"12px"},children:[(0,t.jsx)("span",{style:{fontVariantNumeric:"tabular-nums",fontWeight:600},children:p}),ee&&e.timerRunning&&(0,t.jsx)("button",{onClick:()=>ei(e.id,"deduction"),style:{border:"none",background:"transparent",color:"#e5e7eb",cursor:"pointer",fontSize:"14px",lineHeight:1},"aria-label":"Pause timer",children:"â¸"}),ee&&!e.timerRunning&&(0,t.jsx)("button",{onClick:()=>en(e.id,"deduction"),style:{border:"none",background:"transparent",color:"#e5e7eb",cursor:"pointer",fontSize:"14px",lineHeight:1},"aria-label":"Resume timer",children:"â–¶"})]}),d&&(0,t.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"4px 8px",borderRadius:"6px",border:"1px solid #1f2937",background:e.timerRunning?"#0b1220":"#111827",color:e.timerRunning?"#e5e7eb":"#94a3b8",fontSize:"12px"},children:[(0,t.jsx)("span",{style:{fontVariantNumeric:"tabular-nums",fontWeight:600},children:p}),ee&&e.timerRunning&&(0,t.jsx)("button",{onClick:()=>ei(e.id,"gain"),style:{border:"none",background:"transparent",color:"#e5e7eb",cursor:"pointer",fontSize:"14px",lineHeight:1},"aria-label":"Pause timer",children:"â¸"}),ee&&!e.timerRunning&&(0,t.jsx)("button",{onClick:()=>en(e.id,"gain"),style:{border:"none",background:"transparent",color:"#e5e7eb",cursor:"pointer",fontSize:"14px",lineHeight:1},"aria-label":"Resume timer",children:"â–¶"})]}),d&&(0,t.jsx)("button",{onClick:()=>{ee&&("deduction"===r?l(t=>t.map(t=>t.id===e.id?{...t,bonusActive:!t.bonusActive}:t)):x(t=>t.map(t=>t.id===e.id?{...t,bonusActive:!t.bonusActive}:t)))},style:{border:"none",background:ee?e.bonusActive?"#2d1a1e":"#113227":"#1f2937",color:ee?e.bonusActive?"#fca5a5":"#6ee7b7":"#64748b",padding:"4px 8px",borderRadius:"4px",cursor:ee?"pointer":"not-allowed",fontWeight:600,fontSize:"12px"},disabled:!ee,"aria-label":"Toggle bonus",children:e.bonusActive?"âœ•":"+10"}),s&&"gain"===e.scoreType?(0,t.jsxs)("div",{style:{position:"relative",display:"inline-flex",alignItems:"center"},children:[(0,t.jsx)("select",{value:e.selectedIndex??0,onChange:t=>{var a,i;return a=e.id,i=parseInt(t.target.value,10),void("deduction"===r?l(e=>e.map(e=>e.id===a?{...e,selectedIndex:i}:e)):x(e=>e.map(e=>e.id===a?{...e,selectedIndex:i}:e)))},style:{fontSize:"12px",padding:"4px 28px 4px 8px",borderRadius:"4px",border:"none",backgroundColor:ee?"#113227":"#1f2937",color:ee?"#6ee7b7":"#64748b",fontWeight:500,cursor:ee?"pointer":"not-allowed",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",outline:"none"},disabled:!ee,children:e.criteria.map((r,a)=>(0,t.jsxs)("option",{value:a,children:[r.score," pts"]},`${e.id}-opt-${a}`))}),(0,t.jsx)("span",{style:{position:"absolute",right:"8px",pointerEvents:"none",color:"#e5e7eb",fontSize:"12px"},children:"â–¾"})]}):(0,t.jsx)(m,{value:o}),(0,t.jsx)("button",{onClick:()=>{ee&&("deduction"===r?((e=>{if("bank"!==e.categoryKey)return;let t=Math.abs(e.fixedScore??0);if(t){if("Bank demand deposit"===e.name)return ea(e=>({...e,demand:Math.max(0,(e.demand??0)-t)}));if("Bank term deposit"===e.name){let t=e.id.endsWith("-deduct")?e.id.replace(/-deduct$/,""):e.id;ea(e=>({...e,fixed:e.fixed.filter(e=>e.id!==t)}))}}})(e),l(t=>t.filter(t=>t.id!==e.id))):x(t=>t.filter(t=>t.id!==e.id)))},style:{border:"none",background:"transparent",color:ee?"#94a3b8":"#64748b",cursor:ee?"pointer":"not-allowed",fontSize:"12px",padding:"2px 6px"},disabled:!ee,"aria-label":"Remove item",children:"âœ•"})]}),v&&(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginTop:"4px",justifyContent:"flex-end",flexBasis:"100%"},children:[(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:`repeat(${w}, 1fr)`,gap:"4px",width:"100%",maxWidth:"200px"},children:Array.from({length:w}).map((r,a)=>{let i=a<(y?.count??0);return(0,t.jsx)("div",{style:{height:"6px",borderRadius:"4px",background:i?"#22c55e":"#1f2937",border:"1px solid #1f2937"}},`${e.id}-seg-${a}`)})}),(0,t.jsxs)("span",{style:{color:"#cbd5e1",fontSize:"12px",whiteSpace:"nowrap",marginLeft:"8px"},children:[Math.min(y?.count??0,g.targetCount),"/",g.targetCount]})]})]})},`${r}-${e.id}`)},el=z.fixed.reduce((e,t)=>e+(t.amount??0),0),es=!ee||!j||!H,ed=Number(O),ec=!es&&Number.isFinite(ed)&&ed>0,eu=!es&&Number.isFinite(ed)&&ed>0&&ed<=(z.demand??0);return(0,t.jsxs)("div",{className:a.default.section,style:{border:"2px dashed #2d3b55",borderRadius:"8px",padding:"16px",minHeight:"360px",backgroundColor:"#0f1625",color:"#e5e7eb",boxShadow:"0 6px 20px rgba(0,0,0,0.35)"},onDragOver:e=>{e.preventDefault()},onDrop:e=>{if(e.preventDefault(),!ee)return;let t=e.dataTransfer.getData("application/json");if(t||(t=e.dataTransfer.getData("text/plain")),t)try{let e=JSON.parse(t),r={id:e.id,name:e.name,scoreType:e.scoreType,criteria:e.criteria,baseType:e.baseType,fixedScore:e.score,selectedIndex:0,categoryKey:e.categoryKey,weeklyGoalId:e.weeklyGoalId,bonusActive:!1,timerSeconds:0,timerRunning:!1,timerStartTs:null,timerPaused:!1,count:1};S(r.name)&&(r.customDescription="Expense",r.customScore=0,r.fixedScore=void 0),"deduction"===r.scoreType?l(e=>{let t=r;if(S(r.name))t={...r,id:`${r.id}-${Date.now()}-${Math.random()}`};else if(e.some(e=>e.id===r.id))return e;let a=Date.now(),i={...t,justAdded:!0};return h(t.name)&&(i={...i,timerRunning:!0,timerStartTs:a}),S(t.name)&&A(t.id),setTimeout(()=>{l(e=>e.map(e=>e.id===i.id?{...e,justAdded:!1}:e))},950),[...e,i]}):x(e=>{if(e.some(e=>e.id===r.id))return e;let t=Date.now(),a={...r,justAdded:!0,timerRunning:!0,timerStartTs:t},i=[...e.map(e=>"targetGains"===e.categoryKey?{...e,timerRunning:!1,timerStartTs:null,timerPaused:!1}:e),a];return setTimeout(()=>{x(e=>e.map(e=>e.id===a.id?{...e,justAdded:!1}:e))},950),i})}catch(e){}},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,t.jsx)("div",{className:a.default.dateChip,onClick:()=>_(!0),style:{cursor:"pointer"},role:"button",tabIndex:0,title:"Click to select date",children:(e=>{if(!e)return"";let[t,r,a]=e.split("-");return`${t}-${r}-${a}`})(w)||"â€”"}),(0,t.jsx)("button",{onClick:()=>{k(!1)},style:{background:"transparent",border:"1px solid #334155",color:"#94a3b8",padding:"4px 8px",borderRadius:"6px",fontSize:"12px",cursor:"pointer",transition:"all 120ms ease",display:"flex",alignItems:"center",justifyContent:"center",lineHeight:1},onMouseEnter:e=>{e.currentTarget.style.background="rgba(59, 130, 246, 0.1)",e.currentTarget.style.color="#3b82f6",e.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#94a3b8",e.currentTarget.style.borderColor="#334155"},"aria-label":"Refresh data",title:"Refresh data",children:"â†»"})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[!ee&&(0,t.jsx)("span",{style:{background:"#1f2937",color:"#94a3b8",border:"1px solid #334155",padding:"4px 8px",borderRadius:"6px",fontSize:"12px"},children:"ðŸ”’ locked"}),!Z()&&(0,t.jsx)("button",{onClick:()=>{et(new Date().toISOString().slice(0,10))},style:{background:"transparent",border:"1px solid #334155",color:"#94a3b8",padding:"4px 8px",borderRadius:"6px",fontSize:"12px",cursor:"pointer",transition:"all 120ms ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(59, 130, 246, 0.1)",e.currentTarget.style.color="#3b82f6",e.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#94a3b8",e.currentTarget.style.borderColor="#334155"},"aria-label":"Return to today",children:"current"}),(0,t.jsx)("div",{style:{color:"#94a3b8",fontSize:"12px"},children:"daily record"})]})]}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1px 1fr",gap:"16px"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontWeight:600,marginBottom:"8px",color:"#e5e7eb"},children:"Deductions"}),0===o.length?(0,t.jsx)("div",{style:{color:"#94a3b8",fontSize:"12px"},children:ee?"Drop items here":"Read-only"}):o.map((e,r)=>(0,t.jsx)("div",{children:eo(e,"deduction")},`${r}-${e.id}`))]}),(0,t.jsx)("div",{style:{backgroundColor:"#1f2937",width:"1px"}}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontWeight:600,marginBottom:"8px",color:"#e5e7eb"},children:"Gains"}),I>0&&(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",alignItems:"center",gap:"8px",padding:"8px 10px",borderBottom:"1px solid #1f2937",backgroundColor:"rgba(34, 197, 94, 0.08)",borderRadius:"4px",marginBottom:"4px"},children:[(0,t.jsx)("span",{style:{fontWeight:500,fontSize:"14px",color:"#6ee7b7"},children:"focus"}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,t.jsx)("span",{style:{fontVariantNumeric:"tabular-nums",fontSize:"12px",color:"#94a3b8"},children:b(I)}),(0,t.jsxs)("span",{style:{backgroundColor:"#113227",color:"#6ee7b7",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:500},children:[R," pts"]})]})]}),0===p.length?(0,t.jsx)("div",{style:{color:"#94a3b8",fontSize:"12px"},children:ee?"Drop items here":"Read-only"}):p.map((e,r)=>(0,t.jsx)("div",{children:eo(e,"gain")},`${r}-${e.id}`))]})]}),(0,t.jsxs)("div",{style:{marginTop:"12px",borderTop:"1px solid #1f2937",paddingTop:"12px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px"},children:[(0,t.jsx)("span",{style:{color:"#94a3b8",fontSize:"12px"},children:"Total"}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,t.jsx)(m,{value:E}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",flexWrap:"wrap"},children:[(0,t.jsxs)("span",{style:{color:"#64748b",fontSize:"11px",fontWeight:500},children:[(e=p.reduce((e,t)=>e+f(t),0)+o.reduce((e,t)=>e+f(t),0)+B)>=0?`+${e}`:`${e}`," pts"]}),B>0&&(0,t.jsxs)("span",{style:{color:"#6ee7b7",fontSize:"11px",background:"#113227",padding:"2px 6px",borderRadius:"6px",border:"1px solid rgba(110, 231, 183, 0.35)"},children:["Weekly bounty +",B]})]})]})]}),(0,t.jsxs)("div",{style:{marginTop:"14px",border:"1px solid #1f2937",borderRadius:"10px",padding:"12px",background:"#0b1220"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[(0,t.jsx)("span",{style:{fontWeight:600,color:"#e5e7eb"},children:"Bank"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,t.jsxs)("span",{style:g,children:["Demand ",Math.round(z.demand).toLocaleString("en-US")," pts"]}),(0,t.jsxs)("span",{style:{...g,backgroundColor:"#121826"},children:["Term ",Math.round(el).toLocaleString("en-US")," pts"]})]})]}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"10px",alignItems:"center"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[(0,t.jsx)("input",{type:"text",inputMode:"decimal",pattern:"[0-9]*",value:O,onChange:e=>L(e.target.value.replace(/[^0-9.]/g,"")),placeholder:"Amount",disabled:es,style:{width:"140px",padding:"6px 8px",borderRadius:"6px",border:"1px solid #334155",background:es?"#111827":"#0f1625",color:es?"#475569":"#e5e7eb",fontSize:"13px",outline:"none",MozAppearance:"textfield"}}),(0,t.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"6px",background:"#0f1625",padding:"4px",borderRadius:"8px",border:"1px solid #1f2937"},children:[(0,t.jsx)("button",{onClick:()=>U("demand"),disabled:es,style:{padding:"6px 10px",borderRadius:"6px",border:"none",background:"demand"===F?"#113227":"transparent",color:"demand"===F?"#6ee7b7":"#94a3b8",cursor:es?"not-allowed":"pointer",fontWeight:600,fontSize:"12px"},"aria-label":"Demand deposit",children:"Demand"}),(0,t.jsx)("button",{onClick:()=>U("term"),disabled:es,style:{padding:"6px 10px",borderRadius:"6px",border:"none",background:"term"===F?"#113227":"transparent",color:"term"===F?"#6ee7b7":"#94a3b8",cursor:es?"not-allowed":"pointer",fontWeight:600,fontSize:"12px"},"aria-label":"Term deposit",children:"30d term"})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,t.jsx)("button",{onClick:()=>{if(!ee||!j||!H)return;let e=Number(O);if(!Number.isFinite(e)||e<=0)return;let t=w||new Date().toISOString().slice(0,10),r=`bank-${Date.now()}`;if("demand"===F)ea(t=>({...t,demand:(t.demand??0)+e}));else{let a=new Date(`${t}T00:00:00`);a.setDate(a.getDate()+30);let i={id:r,amount:e,startDate:t,maturityDate:a.toISOString().slice(0,10),rate:.05};ea(e=>({...e,fixed:[...e.fixed,i]}))}let a={id:`${r}-deduct`,name:"demand"===F?"Bank demand deposit":"Bank term deposit",scoreType:"deduction",fixedScore:e,categoryKey:"bank"};l(e=>{let t={...a,justAdded:!0};return setTimeout(()=>{l(e=>e.map(e=>e.id===t.id?{...e,justAdded:!1}:e))},950),[...e,t]}),L("")},disabled:!ec,style:{padding:"8px 12px",borderRadius:"8px",border:"1px solid #334155",background:ec?"#113227":"#111827",color:ec?"#6ee7b7":"#475569",fontWeight:700,fontSize:"12px",cursor:ec?"pointer":"not-allowed"},"aria-label":"Deposit into bank",children:"Deposit"}),(0,t.jsx)("button",{onClick:()=>{if(!ee||!j||!H)return;let e=Number(O);if(!Number.isFinite(e)||e<=0||e>(z.demand??0))return;let t=`bank-withdraw-${Date.now()}`;ea(t=>({...t,demand:Math.max(0,(t.demand??0)-e)}));let r={id:`${t}-gain`,name:"Bank withdrawal",scoreType:"gain",fixedScore:e,categoryKey:"bank"};x(e=>{let t={...r,justAdded:!0};return setTimeout(()=>{x(e=>e.map(e=>e.id===t.id?{...e,justAdded:!1}:e))},950),[...e,t]}),L("")},disabled:!eu,style:{padding:"8px 12px",borderRadius:"8px",border:"1px solid #334155",background:eu?"#22130f":"#111827",color:eu?"#fbbf24":"#475569",fontWeight:700,fontSize:"12px",cursor:eu?"pointer":"not-allowed"},"aria-label":"Withdraw from bank",children:"Withdraw"})]})]}),(0,t.jsx)("div",{style:{textAlign:"right",color:"#94a3b8",fontSize:"12px"},children:"term"===F?`30d \xb7 ${Math.round(5)}% monthly`:"On-call (no interest)"})]}),H&&z.fixed.length>0&&(0,t.jsx)("div",{style:{marginTop:"10px",borderTop:"1px solid #1f2937",paddingTop:"8px",display:"grid",gap:"8px"},children:z.fixed.map(e=>{var r;let a,i,n=(r=e.maturityDate,(a=new Date).setHours(0,0,0,0),(i=new Date(`${r}T00:00:00`)).setHours(0,0,0,0),Math.ceil((i.getTime()-a.getTime())/864e5)),o=Math.round(e.amount*(1+e.rate));return(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto auto",gap:"8px",alignItems:"center",color:"#e5e7eb",fontSize:"12px",background:"#0f1625",borderRadius:"8px",padding:"8px",border:"1px solid #1f2937"},children:[(0,t.jsxs)("span",{style:{fontWeight:600},children:["Term ",e.amount.toLocaleString("en-US")]}),(0,t.jsxs)("span",{style:{color:"#94a3b8"},children:["Maturity ",e.maturityDate]}),(0,t.jsx)("span",{style:{color:n<=0?"#6ee7b7":"#fbbf24",textAlign:"right"},children:n<=0?`Ready +${(100*e.rate).toFixed(1)}%`:`${n}d left`}),(0,t.jsxs)("span",{style:{color:"#94a3b8"},children:["Start ",e.startDate]}),(0,t.jsxs)("span",{style:{color:"#94a3b8"},children:["Expected ",o.toLocaleString("en-US")]}),(0,t.jsxs)("span",{style:{color:"#94a3b8",textAlign:"right"},children:["Rate ",(100*e.rate).toFixed(1),"%"]})]},e.id)})}),!H&&(0,t.jsx)("div",{style:{marginTop:"8px",color:"#94a3b8",fontSize:"12px"},children:"Loading bankâ€¦"})]}),(0,t.jsx)("div",{style:{marginTop:"36px",display:"flex",justifyContent:"flex-end"},children:(0,t.jsx)("button",{className:`${a.default.clearButton} ${D?a.default.clearButtonActive:""}`,onPointerDown:()=>{X.current&&window.clearTimeout(X.current),T(!0),X.current=window.setTimeout(()=>{X.current=null,l([]),x([]),w&&(0,n.clearPersistedState)(w),T(!1)},3e3)},onPointerUp:er,onPointerLeave:er,onPointerCancel:er,disabled:!ee,"aria-label":"Clear all dropped items",children:"Clear"})}),C&&(0,t.jsx)(s,{selectedDate:w,onDateSelect:et,onClose:()=>_(!1)})]})}e.s(["default",()=>w],60057)},88797,e=>{e.v({heatmap:"HistoryHeatmap-module__vd62ca__heatmap",legend:"HistoryHeatmap-module__vd62ca__legend",legendBox:"HistoryHeatmap-module__vd62ca__legendBox",row:"HistoryHeatmap-module__vd62ca__row",tile:"HistoryHeatmap-module__vd62ca__tile",tileFuture:"HistoryHeatmap-module__vd62ca__tileFuture",tileLevel1:"HistoryHeatmap-module__vd62ca__tileLevel1",tileLevel2:"HistoryHeatmap-module__vd62ca__tileLevel2",tileLevel3:"HistoryHeatmap-module__vd62ca__tileLevel3",tileNegative1:"HistoryHeatmap-module__vd62ca__tileNegative1",tileNegative2:"HistoryHeatmap-module__vd62ca__tileNegative2",tileNegative3:"HistoryHeatmap-module__vd62ca__tileNegative3",tileNegativeLight:"HistoryHeatmap-module__vd62ca__tileNegativeLight"})},70030,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(88797),i=e.i(55167),n=e.i(32833),o=e.i(5987);function l({onDateSelect:e}){let[l,s]=(0,r.useState)([]),{setSelectedDate:d}=(0,n.useSelectedDate)(),{selectedIds:c}=(0,o.useDroppedItems)(),u=Array.from(c);return(0,r.useEffect)(()=>{let e=!0,t=new Date;return(0,i.listAllStates)().then(r=>{if(!e)return;let a=new Map;r.forEach(({dateKey:e,state:t})=>{let r,i,n;a.set(e,(r=0,i=0,n=e=>{let t=function(e){if("deduction"===e.scoreType){if(void 0!==e.fixedScore)return Math.abs(e.fixedScore*(e.count??1));if(e.criteria&&e.criteria.length>0&&"duration"===e.baseType){let t=e.criteria[0];if(t&&void 0!==e.timerSeconds)return Math.ceil(t.score/t.time*e.timerSeconds)}return void 0!==e.customScore?Math.abs(e.customScore):0}if(e.criteria&&e.criteria.length>0){let t=Math.max(0,e.selectedIndex??0);return(e.criteria[t]?.score??0)+10*!!e.bonusActive+(e.weeklyRewardBonus??0)}return(e.fixedScore??0)+10*!!e.bonusActive+(e.weeklyRewardBonus??0)}(e),a="deduction"===e.scoreType?-t:t;"bank"===e.categoryKey?i+=a:r+=a},(t.gains??[]).forEach(n),(t.deductions??[]).forEach(n),{visible:r,bank:i}))});let i=new Date(t);i.setDate(t.getDate()-69);let n=i.getDay();i.setDate(i.getDate()-n);let o=new Date(t);o.setDate(t.getDate()+14);let l=Math.ceil((o.getTime()-i.getTime())/6048e5),d=[];for(let e=0;e<l;e++)for(let r=0;r<7;r++){let n=new Date(i);n.setDate(i.getDate()+7*e+r);let o=n.toISOString().slice(0,10),l=n>t,s=a.get(o);d.push({dateKey:o,score:l?0:s?.visible??0,bankScore:s?.bank??0,isFuture:l})}s(d)}),()=>{e=!1}},[u.length]),(0,t.jsx)("div",{className:a.default.heatmap,children:l.map(r=>{var i;return(0,t.jsx)("div",{className:(i=r).isFuture?`${a.default.tile} ${a.default.tileFuture}`:i.score<0?i.score<=-100?`${a.default.tile} ${a.default.tileNegative3}`:i.score<=-50?`${a.default.tile} ${a.default.tileNegative2}`:i.score<=-25?`${a.default.tile} ${a.default.tileNegative1}`:`${a.default.tile} ${a.default.tileNegativeLight}`:i.score>=100?`${a.default.tile} ${a.default.tileLevel3}`:i.score>=50?`${a.default.tile} ${a.default.tileLevel2}`:i.score>=25?`${a.default.tile} ${a.default.tileLevel1}`:a.default.tile,title:`${r.dateKey} \xb7 ${r.score} pts${r.bankScore?` \xb7 bank ${r.bankScore>0?"+":""}${r.bankScore}`:""}${r.isFuture?" Â· upcoming":""}`,onClick:()=>{r.isFuture||(e?e(r.dateKey):d(r.dateKey))},role:r.isFuture?void 0:"button",tabIndex:r.isFuture?void 0:0,style:{cursor:r.isFuture?"default":"pointer",transition:"all 120ms ease"}},r.dateKey)})})}e.s(["default",()=>l])},54284,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(55167);function i(){let[e,i]=(0,r.useState)(!1),[n,o]=(0,r.useState)(!1),[l,s]=(0,r.useState)(!1),[d,c]=(0,r.useState)("788"),u=(0,r.useRef)(null),p=async()=>{try{i(!0);let e=await (0,a.exportAllData)(),t=new Date,r=t.toISOString().slice(0,10),n=t.toTimeString().slice(0,5).replace(":",""),o=`siphor-backup-${r}-${n}.json`,l=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),s=URL.createObjectURL(l),d=document.createElement("a");d.href=s,d.download=o,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(s),alert("âœ“ Data exported successfully")}catch(e){console.error("Export failed:",e),alert("âœ— Export failed. Please try again.")}finally{i(!1)}},x=()=>{u.current&&(window.clearTimeout(u.current),u.current=null)},g=async()=>{let e=parseInt(d,10);if(Number.isNaN(e))return void alert("Please enter a valid number");try{await (0,a.rebuildTotalScoreHistory)(e),alert(`âœ“ Initial value set to ${e}. Totals recalculated.
Refresh to see updated data.`),window.location.reload()}catch(e){console.error(e),alert("Failed to set initial value. Please try again.")}},m={padding:"8px 16px",borderRadius:"8px",fontSize:"13px",cursor:"pointer",transition:"all 150ms ease",fontWeight:600,border:"none"};return(0,t.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,t.jsx)("button",{onMouseDown:()=>{u.current||(u.current=window.setTimeout(()=>{s(!0),u.current=null},1e4))},onMouseUp:x,onMouseLeave:x,title:"Long press 10s to set initial total score",style:{width:"10px",height:"10px",padding:0,borderRadius:"9999px",border:"1px solid #0f172a",background:"#0b1220",opacity:.18,cursor:"pointer"}}),(0,t.jsx)("button",{onClick:()=>{let e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async e=>{let t=e.target.files?.[0];if(t)try{o(!0);let e=await t.text(),r=JSON.parse(e);if(!r.version||!r.exportDate||!Array.isArray(r.data))throw Error("Invalid data format");if(!confirm(`Import data from ${r.exportDate}?
This contains ${r.data.length} day(s) of records.
Existing data for those dates will be overwritten.`))return void o(!1);await (0,a.importAllData)(r),alert(`âœ“ Successfully imported ${r.data.length} day(s) of data.
Please refresh the page to see changes.`),window.location.reload()}catch(e){console.error("Import failed:",e),alert("âœ— Import failed. Please check the file format.")}finally{o(!1)}},e.click()},disabled:n,style:{...m,background:n?"rgba(34, 197, 94, 0.2)":"rgba(34, 197, 94, 0.15)",color:"#6ee7b7",border:"1px solid rgba(34, 197, 94, 0.3)",opacity:n?.6:1},onMouseEnter:e=>{n||(e.currentTarget.style.background="rgba(34, 197, 94, 0.25)",e.currentTarget.style.borderColor="rgba(34, 197, 94, 0.5)")},onMouseLeave:e=>{e.currentTarget.style.background="rgba(34, 197, 94, 0.15)",e.currentTarget.style.borderColor="rgba(34, 197, 94, 0.3)"},title:"Import data from JSON file",children:n?"Importing...":"Import"}),(0,t.jsx)("button",{onClick:p,disabled:e,style:{...m,background:e?"rgba(59, 130, 246, 0.2)":"rgba(59, 130, 246, 0.15)",color:"#60a5fa",border:"1px solid rgba(59, 130, 246, 0.3)",opacity:e?.6:1},onMouseEnter:t=>{e||(t.currentTarget.style.background="rgba(59, 130, 246, 0.25)",t.currentTarget.style.borderColor="rgba(59, 130, 246, 0.5)")},onMouseLeave:e=>{e.currentTarget.style.background="rgba(59, 130, 246, 0.15)",e.currentTarget.style.borderColor="rgba(59, 130, 246, 0.3)"},title:"Export all data to JSON file",children:e?"Exporting...":"Export"}),l&&(0,t.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:()=>s(!1),children:(0,t.jsxs)("div",{onClick:e=>e.stopPropagation(),style:{background:"#0f172a",border:"1px solid #1f2937",borderRadius:"10px",padding:"20px",width:"320px",color:"#e5e7eb",boxShadow:"0 12px 30px rgba(0,0,0,0.45)"},children:[(0,t.jsx)("h3",{style:{margin:"0 0 12px",fontSize:"16px",fontWeight:600},children:"Set Initial Total Score"}),(0,t.jsx)("p",{style:{margin:"0 0 12px",fontSize:"13px",color:"#cbd5e1"},children:"Set the initial value for 1970-01-01 and rebuild cumulative totals."}),(0,t.jsx)("input",{type:"number",value:d,onChange:e=>c(e.target.value),style:{width:"100%",padding:"8px 10px",borderRadius:"6px",border:"1px solid #334155",background:"#0b1220",color:"#e5e7eb",fontSize:"14px",marginBottom:"14px"}}),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[(0,t.jsx)("button",{onClick:()=>s(!1),style:{...m,background:"transparent",color:"#94a3b8",border:"1px solid #334155",padding:"8px 12px"},children:"Cancel"}),(0,t.jsx)("button",{onClick:g,style:{...m,background:"#10b981",color:"#ffffff",padding:"8px 12px"},children:"Confirm"})]})]})})]})}e.s(["default",()=>i])},69511,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(89050),i=e.i(32833),n=e.i(5987),o=e.i(55167);function l(){let{selectedDate:e}=(0,i.useSelectedDate)(),{notifyBountyUpdate:l}=(0,n.useDroppedItems)(),[s,d]=(0,r.useState)([]),[c,u]=(0,r.useState)(!0),[p,x]=(0,r.useState)({title:"",points:""}),g=(0,r.useMemo)(()=>new Date().toISOString().slice(0,10),[]),m=(0,r.useMemo)(()=>(0,a.getWeekKey)(e),[e]),f=m===(0,r.useMemo)(()=>(0,a.getWeekKey)(g),[g]);(0,r.useEffect)(()=>{let e=!0;return u(!0),(0,o.loadWeeklyBounties)(m).then(t=>{e&&d(t.items??[])}).finally(()=>{e&&u(!1)}),()=>{e=!1}},[m]);let b=async t=>{f&&(d((await (0,o.toggleWeeklyBounty)(m,t,e)).items),l())},y=async()=>{if(!f)return;let e=Number(p.points);d((await (0,o.addWeeklyBounty)(m,p.title,e)).items),x({title:"",points:""})},h={backgroundColor:"rgba(110, 231, 183, 0.12)",outline:"1px solid rgba(110, 231, 183, 0.28)",borderRadius:"8px"};return(0,t.jsxs)("div",{style:{border:"2px solid #243046",borderRadius:"10px",backgroundColor:"#0f1625",overflow:"hidden",boxShadow:"0 6px 20px rgba(0,0,0,0.35)"},children:[(0,t.jsxs)("div",{style:{padding:"14px 16px",borderBottom:"1px solid #1f2937",backgroundColor:"#111827",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontWeight:700,color:"#e5e7eb",fontSize:"15px"},children:"Weekly Bounties"}),(0,t.jsx)("div",{style:{color:"#94a3b8",fontSize:"12px",marginTop:"2px"},children:"Current week only. Check to claim once."})]}),!f&&(0,t.jsx)("span",{style:{color:"#94a3b8",fontSize:"12px",border:"1px solid #334155",borderRadius:"6px",padding:"4px 8px"},children:"Locked"})]}),(0,t.jsxs)("div",{style:{padding:"12px 14px",display:"grid",gap:"10px"},children:[c?(0,t.jsx)("div",{style:{color:"#94a3b8",fontSize:"12px"},children:"Loadingâ€¦"}):0===s.length?(0,t.jsx)("div",{style:{color:"#94a3b8",fontSize:"12px"},children:"No bounties yet. Add one below."}):s.map(e=>{let r=!!e.completedDate;return(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr auto",gap:"10px",alignItems:"center",padding:"10px 12px",border:"1px solid #1f2937",borderRadius:"8px",...r?h:{}},children:[(0,t.jsx)("input",{type:"checkbox",checked:r,onChange:()=>b(e.id),disabled:!f,style:{width:"16px",height:"16px"},"aria-label":"Complete bounty"}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,t.jsx)("span",{style:{color:"#e5e7eb",fontWeight:600,fontSize:"14px"},children:e.title}),(0,t.jsx)("span",{style:{color:"#94a3b8",fontSize:"12px"},children:r?`Completed on ${e.completedDate}`:"Incomplete"})]}),(0,t.jsxs)("span",{style:{backgroundColor:"#113227",color:"#6ee7b7",padding:"4px 8px",borderRadius:"6px",fontSize:"12px",fontWeight:700},children:[e.points," pts"]})]},e.id)}),(0,t.jsxs)("div",{style:{borderTop:"1px solid #1f2937",paddingTop:"10px",display:"grid",gap:"8px"},children:[(0,t.jsx)("div",{style:{color:"#e5e7eb",fontWeight:600,fontSize:"13px"},children:"Add bounty"}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px auto",gap:"8px",alignItems:"center"},children:[(0,t.jsx)("input",{type:"text",placeholder:"Title",value:p.title,onChange:e=>x(t=>({...t,title:e.target.value})),disabled:!f,style:{padding:"8px 10px",borderRadius:"6px",border:"1px solid #334155",backgroundColor:"#0b1220",color:"#e5e7eb",fontSize:"13px"}}),(0,t.jsx)("input",{type:"text",inputMode:"decimal",pattern:"[0-9]*",placeholder:"Points",value:p.points,onChange:e=>x(t=>({...t,points:e.target.value.replace(/[^0-9.]/g,"")})),disabled:!f,style:{padding:"8px 10px",borderRadius:"6px",border:"1px solid #334155",backgroundColor:"#0b1220",color:"#e5e7eb",fontSize:"13px",textAlign:"right"}}),(0,t.jsx)("button",{onClick:y,disabled:!f||!p.title.trim()||0>=Number(p.points),style:{padding:"8px 12px",borderRadius:"8px",border:"1px solid #334155",backgroundColor:!f||!p.title.trim()||0>=Number(p.points)?"#111827":"#113227",color:!f||!p.title.trim()||0>=Number(p.points)?"#475569":"#6ee7b7",fontWeight:700,fontSize:"12px",cursor:!f||!p.title.trim()||0>=Number(p.points)?"not-allowed":"pointer"},"aria-label":"Add bounty",children:"Add"})]}),!f&&(0,t.jsx)("div",{style:{color:"#94a3b8",fontSize:"12px"},children:"Editing is limited to the current week."})]})]})]})}e.s(["default",()=>l])}]);